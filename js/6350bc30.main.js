/**
 * @license almond 0.3.0 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/* Copyright © 2015-2016 David Valdman */

/* Copyright © 2015 David Valdman */

!function(){var t,e,i;!function(n){function s(t,e){return b.call(t,e)}function r(t,e){var i,n,s,r,o,a,u,c,p,h,l,d=e&&e.split("/"),f=_.map,m=f&&f["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=t.split("/"),o=t.length-1,_.nodeIdCompat&&T.test(t[o])&&(t[o]=t[o].replace(T,"")),t=d.concat(t),p=0;p<t.length;p+=1)if(l=t[p],"."===l)t.splice(p,1),p-=1;else if(".."===l){if(1===p&&(".."===t[2]||".."===t[0]))break;p>0&&(t.splice(p-1,2),p-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||m)&&f){for(i=t.split("/"),p=i.length;p>0;p-=1){if(n=i.slice(0,p).join("/"),d)for(h=d.length;h>0;h-=1)if(s=f[d.slice(0,h).join("/")],s&&(s=s[n])){r=s,a=p;break}if(r)break;!u&&m&&m[n]&&(u=m[n],c=p)}!r&&u&&(r=u,a=c),r&&(i.splice(0,a,r),t=i.join("/"))}return t}function o(t,e){return function(){var i=O.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),d.apply(n,i.concat([t,e]))}}function a(t){return function(e){return r(e,t)}}function u(t){return function(e){v[t]=e}}function c(t){if(s(y,t)){var e=y[t];delete y[t],g[t]=!0,l.apply(n,e)}if(!s(v,t)&&!s(g,t))throw new Error("No "+t);return v[t]}function p(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function h(t){return function(){return _&&_.config&&_.config[t]||{}}}var l,d,f,m,v={},y={},_={},g={},b=Object.prototype.hasOwnProperty,O=[].slice,T=/\.js$/;f=function(t,e){var i,n=p(t),s=n[0];return t=n[1],s&&(s=r(s,e),i=c(s)),s?t=i&&i.normalize?i.normalize(t,a(e)):r(t,e):(t=r(t,e),n=p(t),s=n[0],t=n[1],s&&(i=c(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:i}},m={require:function(t){return o(t)},exports:function(t){var e=v[t];return"undefined"!=typeof e?e:v[t]={}},module:function(t){return{id:t,uri:"",exports:v[t],config:h(t)}}},l=function(t,e,i,r){var a,p,h,l,d,_,b=[],O=typeof i;if(r=r||t,"undefined"===O||"function"===O){for(e=!e.length&&i.length?["require","exports","module"]:e,d=0;d<e.length;d+=1)if(l=f(e[d],r),p=l.f,"require"===p)b[d]=m.require(t);else if("exports"===p)b[d]=m.exports(t),_=!0;else if("module"===p)a=b[d]=m.module(t);else if(s(v,p)||s(y,p)||s(g,p))b[d]=c(p);else{if(!l.p)throw new Error(t+" missing "+p);l.p.load(l.n,o(r,!0),u(p),{}),b[d]=v[p]}h=i?i.apply(v[t],b):void 0,t&&(a&&a.exports!==n&&a.exports!==v[t]?v[t]=a.exports:h===n&&_||(v[t]=h))}else t&&(v[t]=i)},t=e=d=function(t,e,i,s,r){if("string"==typeof t)return m[t]?m[t](e):c(f(t,e).f);if(!t.splice){if(_=t,_.deps&&d(_.deps,_.callback),!e)return;e.splice?(t=e,e=i,i=null):t=n}return e=e||function(){},"function"==typeof i&&(i=s,s=r),s?l(n,t,e,i):setTimeout(function(){l(n,t,e,i)},4),d},d.config=function(t){return d(t)},t._defined=v,i=function(t,e,i){e.splice||(i=e,e=[]),s(v,t)||s(y,t)||(y[t]=[t,e,i])},i.amd={jQuery:!0}}(),i("almond",function(){}),i("samsara/dom/_DOMAllocator",["require","exports","module"],function(t,e,i){function n(t){this.set(t),this.detachedNodes={}}n.prototype.set=function(t){t||(t=document.createDocumentFragment()),this.container=t},n.prototype.migrate=function(t){var e=this.container;if(t!==e){if(e instanceof DocumentFragment)t.appendChild(e);else for(;e.hasChildNodes();)t.appendChild(e.firstChild);this.container=t}},n.prototype.allocate=function(t){t=t.toLowerCase(),t in this.detachedNodes||(this.detachedNodes[t]=[]);var e,i=this.detachedNodes[t];return 0===i.length?(e=document.createElement(t),this.container.appendChild(e)):e=i.shift(),e},n.prototype.deallocate=function(t){var e=t.nodeName.toLowerCase(),i=this.detachedNodes[e];i.push(t)},i.exports=n}),i("samsara/events/EventEmitter",["require","exports","module"],function(t,e,i){function n(){this.listeners={},this._owner=this}n.prototype.emit=function(t,e){if(e!==!1){var i=this.listeners[t];if(i)for(var n=0;n<i.length;n++)i[n].call(this._owner,e)}},n.prototype.trigger=n.prototype.emit,n.prototype.on=function(t,e){t in this.listeners||(this.listeners[t]=[]),this.listeners[t].push(e)},n.prototype.once=function(t,e){var i=function(){n.prototype.off.call(this._owner,t,i),e.apply(this._owner,arguments)}.bind(this);this.on(t,i)},n.prototype.off=function(t,e){if(!t)return this.listeners={},!0;var i=this.listeners[t];if(void 0!==i)if(e){var n=i.indexOf(e);n>=0&&i.splice(n,1)}else this.listeners[t]=[];return 0===this.listeners[t].length},n.prototype.bindThis=function(t){this._owner=t},i.exports=n}),i("samsara/events/EventHandler",["require","exports","module","./EventEmitter"],function(t,e,i){function n(){s.apply(this,arguments),this.upstream=[],this.upstreamListeners={}}var s=t("./EventEmitter");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.setInputHandler=function(t,e){t.trigger=e.trigger.bind(e),t.subscribe=e.subscribe.bind(e),t.unsubscribe=e.unsubscribe.bind(e)},n.setOutputHandler=function(t,e){e.bindThis(t),t.emit=e.emit.bind(e),t.on=e.on.bind(e),t.off=e.off.bind(e)},n.prototype.on=function(t,e){if(s.prototype.on.apply(this,arguments),!(t in this.upstreamListeners)){var i=this.trigger.bind(this,t);this.upstreamListeners[t]=i;for(var n=0;n<this.upstream.length;n++)this.upstream[n].on(t,i)}},n.prototype.off=function(t,e){var i=s.prototype.off.apply(this,arguments);if(i&&this.upstreamListeners[t]){var n=this.upstreamListeners[t];delete this.upstreamListeners[t];for(var r=0;r<this.upstream.length;r++)this.upstream[r].off(t,n)}},n.prototype.subscribe=function(t){var e=this.upstream.indexOf(t);if(0>e){this.upstream.push(t);for(var i in this.upstreamListeners)t.on(i,this.upstreamListeners[i])}return t},n.prototype.unsubscribe=function(t){if(t){var e=this.upstream.indexOf(t);if(e>=0){this.upstream.splice(e,1);for(var i in this.upstreamListeners)t.off(i,this.upstreamListeners[i])}}else for(var n=0;n<this.upstream.length;n++)this.unsubscribe(this.upstream[n])},i.exports=n}),i("samsara/core/queues/postTickQueue",["require","exports","module"],function(t,e,i){i.exports=[]}),i("samsara/core/queues/preTickQueue",["require","exports","module"],function(t,e,i){i.exports=[]}),i("samsara/core/queues/dirtyQueue",["require","exports","module"],function(t,e,i){i.exports=[]}),i("samsara/core/queues/tickQueue",["require","exports","module"],function(t,e,i){i.exports=[]}),i("samsara/core/Transform",["require","exports","module"],function(t,e,i){function n(t){return 2===t.length?t[0]*t[0]+t[1]*t[1]:t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function s(t){return Math.sqrt(n(t))}function r(t){return 0>t?-1:1}var o={};o.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o.inFront=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,1.001,1],o.behind=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,-1.001,1],o.compose=function(t,e){return t===o.identity?e.slice():e===o.identity?t.slice():[t[0]*e[0]+t[4]*e[1]+t[8]*e[2],t[1]*e[0]+t[5]*e[1]+t[9]*e[2],t[2]*e[0]+t[6]*e[1]+t[10]*e[2],0,t[0]*e[4]+t[4]*e[5]+t[8]*e[6],t[1]*e[4]+t[5]*e[5]+t[9]*e[6],t[2]*e[4]+t[6]*e[5]+t[10]*e[6],0,t[0]*e[8]+t[4]*e[9]+t[8]*e[10],t[1]*e[8]+t[5]*e[9]+t[9]*e[10],t[2]*e[8]+t[6]*e[9]+t[10]*e[10],0,t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14],1]},o.composeMany=function(){if(arguments.length>2){var t=arguments[0],e=arguments[1];return Array.prototype.shift.call(arguments),arguments[0]=o.compose(t,e),o.composeMany.apply(null,arguments)}return o.compose.apply(null,arguments)},o.thenMove=function(t,e){return e[2]||(e[2]=0),[t[0],t[1],t[2],0,t[4],t[5],t[6],0,t[8],t[9],t[10],0,t[12]+e[0],t[13]+e[1],t[14]+e[2],1]},o.moveThen=function(t,e){t[2]||(t[2]=0);var i=t[0]*e[0]+t[1]*e[4]+t[2]*e[8],n=t[0]*e[1]+t[1]*e[5]+t[2]*e[9],s=t[0]*e[2]+t[1]*e[6]+t[2]*e[10];return o.thenMove(e,[i,n,s])},o.translate=function(t){var e=t[0]||0,i=t[1]||0,n=t[2]||0;return[1,0,0,0,0,1,0,0,0,0,1,0,e,i,n,1]},o.translateX=function(t){return[1,0,0,0,0,1,0,0,0,0,1,0,t,0,0,1]},o.translateY=function(t){return[1,0,0,0,0,1,0,0,0,0,1,0,0,t,0,1]},o.translateZ=function(t){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,t,1]},o.scale=function(t){var e=void 0!==t[0]?t[0]:1,i=void 0!==t[1]?t[1]:1,n=void 0!==t[2]?t[2]:1;return[e,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1]},o.scaleX=function(t){return[t,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},o.scaleY=function(t){return[1,0,0,0,0,t,0,0,0,0,1,0,0,0,0,1]},o.scaleZ=function(t){return[1,0,0,0,0,1,0,0,0,0,t,0,0,0,0,1]},o.thenScale=function(t,e){var i=void 0!==e[0]?e[0]:1,n=void 0!==e[1]?e[1]:1,s=void 0!==e[2]?e[2]:1;return[i*t[0],n*t[1],s*t[2],0,i*t[4],n*t[5],s*t[6],0,i*t[8],n*t[9],s*t[10],0,i*t[12],n*t[13],s*t[14],1]},o.rotateX=function(t){var e=Math.cos(t),i=Math.sin(t);return[1,0,0,0,0,e,i,0,0,-i,e,0,0,0,0,1]},o.rotateY=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,0,-i,0,0,1,0,0,i,0,e,0,0,0,0,1]},o.rotateZ=function(t){var e=Math.cos(t),i=Math.sin(t);return[e,i,0,0,-i,e,0,0,0,0,1,0,0,0,0,1]},o.skewX=function(t){return[1,0,0,0,Math.tan(t),1,0,0,0,0,1,0,0,0,0,1]},o.skewY=function(t){return[1,Math.tan(t),0,0,0,1,0,0,0,0,1,0,0,0,0,1]},o.rotateAxis=function(t,e){var i=Math.sin(e),n=1-Math.cos(e),s=1-n,r=t[0]*t[0]*s,o=t[0]*t[1]*s,a=t[0]*t[2]*s,u=t[1]*t[1]*s,c=t[1]*t[2]*s,p=t[2]*t[2]*s,h=t[0]*i,l=t[1]*i,d=t[2]*i;return[r+n,o+d,a-l,0,o-d,u+n,c+h,0,a+l,c-h,p+n,0,0,0,0,1]},o.aboutOrigin=function(t,e){t[2]=t[2]||0;var i=t[0]-(t[0]*e[0]+t[1]*e[4]+t[2]*e[8]),n=t[1]-(t[0]*e[1]+t[1]*e[5]+t[2]*e[9]),s=t[2]-(t[0]*e[2]+t[1]*e[6]+t[2]*e[10]);return o.thenMove(e,[i,n,s])},o.getTranslate=function(t){return[t[12],t[13],t[14]]},o.inverse=function(t){var e=t[5]*t[10]-t[6]*t[9],i=t[4]*t[10]-t[6]*t[8],n=t[4]*t[9]-t[5]*t[8],s=t[1]*t[10]-t[2]*t[9],r=t[0]*t[10]-t[2]*t[8],o=t[0]*t[9]-t[1]*t[8],a=t[1]*t[6]-t[2]*t[5],u=t[0]*t[6]-t[2]*t[4],c=t[0]*t[5]-t[1]*t[4],p=t[0]*e-t[1]*i+t[2]*n,h=1/p,l=[h*e,-h*s,h*a,0,-h*i,h*r,-h*u,0,h*n,-h*o,h*c,0,0,0,0,1];return l[12]=-t[12]*l[0]-t[13]*l[4]-t[14]*l[8],l[13]=-t[12]*l[1]-t[13]*l[5]-t[14]*l[9],l[14]=-t[12]*l[2]-t[13]*l[6]-t[14]*l[10],l},o.transpose=function(t){return[t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]]},o.interpret=function(t){var e=[t[0],t[1],t[2]],i=r(e[0]),a=s(e),u=[e[0]+i*a,e[1],e[2]],c=2/n(u);if(c>=1/0)return{translate:o.getTranslate(t),rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]};var p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];p[0]=1-c*u[0]*u[0],p[5]=1-c*u[1]*u[1],p[10]=1-c*u[2]*u[2],p[1]=-c*u[0]*u[1],p[2]=-c*u[0]*u[2],p[6]=-c*u[1]*u[2],p[4]=p[1],p[8]=p[2],p[9]=p[6];var h=o.compose(p,t),l=[h[5],h[6]],d=r(l[0]),f=s(l),m=[l[0]+d*f,l[1]],v=2/n(m),y=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];y[5]=1-v*m[0]*m[0],y[10]=1-v*m[1]*m[1],y[6]=-v*m[0]*m[1],y[9]=y[6];var _=o.compose(y,p),g=o.compose(_,t),b=o.scale([g[0]<0?-1:1,g[5]<0?-1:1,g[10]<0?-1:1]);g=o.compose(g,b),_=o.compose(b,_);var O={};return O.translate=o.getTranslate(t),O.rotate=[Math.atan2(-_[6],_[10]),Math.asin(_[2]),Math.atan2(-_[1],_[0])],O.rotate[0]||(O.rotate[0]=0,O.rotate[2]=Math.atan2(_[4],_[5])),O.scale=[g[0],g[5],g[10]],O.skew=[Math.atan2(g[9],O.scale[2]),Math.atan2(g[8],O.scale[2]),Math.atan2(g[4],O.scale[0])],Math.abs(O.rotate[0])+Math.abs(O.rotate[2])>1.5*Math.PI&&(O.rotate[1]=Math.PI-O.rotate[1],O.rotate[1]>Math.PI?O.rotate[1]-=2*Math.PI:O.rotate[1]<-Math.PI&&(O.rotate[1]+=2*Math.PI),O.rotate[0]<0?O.rotate[0]+=Math.PI:O.rotate[0]-=Math.PI,O.rotate[2]<0?O.rotate[2]+=Math.PI:O.rotate[2]-=Math.PI),O},o.build=function(t){var e=o.scale(t.scale[0],t.scale[1],t.scale[2]),i=o.skew(t.skew[0],t.skew[1],t.skew[2]),n=o.rotate(t.rotate[0],t.rotate[1],t.rotate[2]);return o.thenMove(o.compose(o.compose(n,i),e),t.translate)},o.average=function(t,e,i){i=void 0===i?.5:i;for(var n=o.interpret(t),s=o.interpret(e),r={translate:[0,0,0],rotate:[0,0,0],scale:[0,0,0],skew:[0,0,0]},a=0;3>a;a++)r.translate[a]=(1-i)*n.translate[a]+i*s.translate[a],r.rotate[a]=(1-i)*n.rotate[a]+i*s.rotate[a],r.scale[a]=(1-i)*n.scale[a]+i*s.scale[a],r.skew[a]=(1-i)*n.skew[a]+i*s.skew[a];return o.build(r)},o.equals=function(t,e){return!o.notEquals(t,e)},o.notEquals=function(t,e){return t===e?!1:!(t&&e)||t[12]!==e[12]||t[13]!==e[13]||t[14]!==e[14]||t[0]!==e[0]||t[1]!==e[1]||t[2]!==e[2]||t[4]!==e[4]||t[5]!==e[5]||t[6]!==e[6]||t[8]!==e[8]||t[9]!==e[9]||t[10]!==e[10]},i.exports=o}),i("samsara/core/Timer",["require","exports","module","./queues/tickQueue"],function(t,e,i){function n(t){return r.push(t),t}function s(t){var e=r.indexOf(t);-1!==e&&r.splice(e,1)}var r=t("./queues/tickQueue"),o={},a=window.performance?function(){return window.performance.now()}:Date.now;o.setTimeout=function(t,e){function i(){var n=a();n-s>=e&&(t.apply(this,arguments),o.clear(i))}var s=a();return n(i)},o.setInterval=function(t,e){function i(){var i=a();i-s>=e&&(t.apply(this,arguments),s=a())}var s=a();return n(i)},o.after=function(t,e){function i(){e--,0>=e&&(t.apply(this,arguments),o.clear(i))}if(void 0!==e)return n(i)},o.every=function(t,e){function i(){e--,0>=e&&(t.apply(this,arguments),e=s)}e=e||1;var s=e;return n(i)},o.clear=function(t){s(t)},o.debounce=function(t,e){var i;return function(){var n=arguments,s=function(){o.clear(i),i=null,t.apply(this,n)}.bind(this);i&&o.clear(i),i=o.setTimeout(s,e)}},o.frameDebounce=function(t,e){var i;return function(){var n=arguments,s=function(){i=null,t.apply(this,n)}.bind(this);i&&o.clear(i),i=o.after(s,e)}},i.exports=o}),i("samsara/core/Engine",["require","exports","module","../events/EventHandler","./queues/postTickQueue","./queues/preTickQueue","./queues/dirtyQueue","./queues/tickQueue","./Transform","./Timer"],function(t,e,i){function n(){u.push(s),u.push(r),isNaN(d)&&_.start()}function s(){var t=window.innerHeight,e=window.innerWidth;if(f){var i=t>e;if(m===i&&e===v)return!1;m=i,_.size.emit("start"),c.push(function(){_.size.emit("end","end")})}else{if(e===v&&t===y)return!1;v=e,y=t,g?a.push(function(){_.size.emit("update"),O()}):(_.size.emit("start"),g=!0,O())}}function r(){_.layout.trigger("start",T),c.push(function(){_.layout.trigger("end",T)})}var o=t("../events/EventHandler"),a=t("./queues/postTickQueue"),u=t("./queues/preTickQueue"),c=t("./queues/dirtyQueue"),p=t("./queues/tickQueue"),h=t("./Transform"),l=t("./Timer"),d=Number.NaN,f=/mobi/i.test(window.navigator.userAgent),m=Number.NaN,v=Number.NaN,y=Number.NaN;window.addEventListener("resize",s,!1);var _={};_.size=new o,_.layout=new o,_.step=function(){for(;u.length;)u.shift()();for(var t=0;t<p.length;t++)p[t]();for(;a.length;)a.shift()();for(;c.length;)c.shift()()},_.start=function S(){_.step(),d=window.requestAnimationFrame(S)},_.stop=function(){window.cancelAnimationFrame(d),d=Number.NaN},_.registerContext=function(t){t._size.subscribe(_.size),t._layout.subscribe(_.layout),window.Promise?window.Promise.resolve().then(n):window.requestAnimationFrame(n)},_.deregisterContext=function(t){t._size.unsubscribe(_.size),t._layout.unsubscribe(_.layout)};var g=!1,b=150,O=l.debounce(function(){c.push(function(){_.size.emit("end","end"),g=!1})},b),T={transform:h.identity,opacity:1,origin:null,align:null,nextSizeTransform:h.identity};i.exports=_}),i("samsara/events/EventMapper",["require","exports","module","./EventHandler"],function(t,e,i){function n(t){s.call(this),this._mappingFunction=t}var s=t("./EventHandler");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.emit=function(t,e){var i=this._mappingFunction(e);s.prototype.emit.call(this,t,i)},n.prototype.trigger=n.prototype.emit,i.exports=n}),i("samsara/events/EventFilter",["require","exports","module","./EventHandler"],function(t,e,i){function n(t){s.call(this),this._condition=t}var s=t("./EventHandler");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.emit=function(t,e){this._condition(e)&&s.prototype.emit.apply(this,arguments)},n.prototype.trigger=n.prototype.emit,i.exports=n}),i("samsara/events/EventSplitter",["require","exports","module","./EventHandler"],function(t,e,i){function n(t){s.call(this),this._splitter=t,this.on("start",function(){}),this.on("update",function(){}),this.on("end",function(){})}var s=t("./EventHandler");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.emit=function(t,e){var i=this._splitter.call(this,e);i&&i.emit instanceof Function&&i.emit(t,e)},n.prototype.trigger=n.prototype.emit,i.exports=n}),i("samsara/streams/SimpleStream",["require","exports","module","../events/EventHandler","../events/EventMapper","../events/EventFilter","../events/EventSplitter"],function(t,e,i){function n(){s.call(this)}var s=t("../events/EventHandler"),r=t("../events/EventMapper"),o=t("../events/EventFilter"),a=t("../events/EventSplitter");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.map=function(t){var e=new n,i=new r(t);return e.subscribe(i).subscribe(this),e},n.prototype.filter=function u(t){var u=new o(t),e=new n;return e.subscribe(u).subscribe(this),e},n.prototype.split=function(t){var e=new a(t);e.subscribe(this)},n.prototype.pluck=function(t){return this.map(function(e){return e[t]})},i.exports=n}),i("samsara/streams/_MergedStream",["require","exports","module","./SimpleStream","./Stream"],function(t,e,i){function n(e){this.mergedData=e instanceof Array?[]:{},this.streamCache={};var i=t("./Stream");i.call(this,{start:function(){return this.mergedData}.bind(this),update:function(){return this.mergedData}.bind(this),end:function(){return this.mergedData}.bind(this)});for(var n in e)this.addStream(n,e[n])}var s=t("./SimpleStream");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.addStream=function(t,e){var i=this.mergedData;e instanceof Object&&e.on?(i[t]=void 0,e.on("start",function(e){i[t]=e}),e.on("update",function(e){i[t]=e}),e.on("end",function(e){i[t]=e}),this.subscribe(e)):i[t]=e,this.streamCache[t]=e},n.prototype.removeStream=function(t){var e=this.streamCache[t];if(this.unsubscribe(e),delete this.streamCache[t],this.mergedData instanceof Array){var i=this.mergedData.indexOf(t);this.mergedData.splice(i,1)}else delete this.mergedData[t]},n.prototype.replaceStream=function(t,e){this.removeStream(t),this.addStream(t,e)},i.exports=n}),i("samsara/streams/_LiftedStream",["require","exports","module","./SimpleStream","../events/EventMapper"],function(t,e,i){function n(t,e){s.call(this);var i=new r(function(e){return t.apply(null,e)});this.mergedStream=e,this.subscribe(i).subscribe(e)}var s=t("./SimpleStream"),r=t("../events/EventMapper");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.replaceStream=function(){this.mergedStream.replaceStream.apply(this.mergedStream,arguments)},i.exports=n}),i("samsara/streams/Stream",["require","exports","module","./_MergedStream","./_LiftedStream","../events/EventHandler","../streams/SimpleStream","../core/queues/preTickQueue","../core/queues/postTickQueue","../core/queues/dirtyQueue"],function(t,e,i){function n(t){function e(e){var i=t&&t.start?t.start(e):e;i!==!1&&this.emit(h.START,i),a=!1}function i(e){var i=t&&t.update?t.update(e):e;i!==!1&&this.emit(h.UPDATE,i),l=!1}function n(e){var i=t&&t.end?t.end(e):e;i!==!1&&this.emit(h.END,i),d=!1}this._eventInput=new o,this._eventOutput=new o,o.setInputHandler(this,this._eventInput),o.setOutputHandler(this,this._eventOutput);var s=0,r=!1,a=!1,l=!1,d=!1;this._eventInput.on(h.START,function(t){return s++,a||r?!1:(a=!0,void u.push(e.bind(this,t)))}.bind(this)),this._eventInput.on(h.UPDATE,function(t){return r=!0,l?!1:(l=!0,void c.push(i.bind(this,t)))}.bind(this)),this._eventInput.on(h.END,function(t){return s--,r&&s>0?(i.call(this,t),!1):(r=!1,void(d||(d=!0,p.push(n.bind(this,t)))))}.bind(this))}var s=t("./_MergedStream"),r=t("./_LiftedStream"),o=t("../events/EventHandler"),a=t("../streams/SimpleStream"),u=t("../core/queues/preTickQueue"),c=t("../core/queues/postTickQueue"),p=t("../core/queues/dirtyQueue"),h={START:"start",UPDATE:"update",END:"end"};n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.merge=function(t){return new s(t)},n.lift=function(t,e){return new r(t,new s(e))},i.exports=n}),i("samsara/streams/Observable",["require","exports","module","../streams/SimpleStream","../core/queues/preTickQueue","../core/queues/dirtyQueue"],function(t,e,i){function n(t){s.call(this),this.value=t,void 0!==t&&this.set(t)}var s=t("../streams/SimpleStream"),r=t("../core/queues/preTickQueue"),o=t("../core/queues/dirtyQueue");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.get=function(){return this.value},n.prototype.set=function(t){var e=this;e.value=t,r.push(function(){e.emit("start",t),o.push(function(){e.emit("end",t)})})},i.exports=n}),i("samsara/core/nodes/Node",["require","exports","module","../../events/EventHandler","../../streams/SimpleStream","../../streams/Stream","../../streams/Observable"],function(t,e,i){function n(t){this.stream=s(t),r.setOutputHandler(this,this.stream)}function s(t){for(var e in t){var i=t[e];if(!(i instanceof o)){var n=new u(i);t[e]=n}}return a.merge(t)}var r=t("../../events/EventHandler"),o=t("../../streams/SimpleStream"),a=t("../../streams/Stream"),u=t("../../streams/Observable");n.prototype.set=function(t){for(var e in t){var i=t[e],n=i instanceof o?i:new u(i);this.stream.addStream(e,n)}},i.exports=n}),i("samsara/core/nodes/LayoutNode",["require","exports","module","./Node"],function(t,e,i){function n(t){s.call(this,t)}var s=t("./Node");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.KEYS={transform:!0,origin:!0,align:!0,opacity:!0},i.exports=n}),i("samsara/core/nodes/SizeNode",["require","exports","module","./Node"],function(t,e,i){function n(t){s.call(this,t)}var s=t("./Node");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.KEYS={size:!0,proportions:!0,margins:!0,aspectRatio:!0},i.exports=n}),i("samsara/core/algebras/layout",["require","exports","module","../../core/Transform"],function(t,e,i){function n(t,e,i){var n=void 0!==e.opacity?e.opacity:o.OPACITY,a=e.transform||o.TRANSFORM,u=t.origin||o.ORIGIN,c=t.align||o.ALIGN,p=void 0!==t.opacity?n*t.opacity:n,h=t.transform?r.compose(a,t.transform):a,l=t.origin?a:e.nextSizeTransform||a;if(t.size&&(l=a),u&&(u[0]||u[1])){var d="number"==typeof i[0]?-u[0]*i[0]:0,f="number"==typeof i[1]?-u[1]*i[1]:0;h=r.moveThen([d,f,0],h),u=null}if(i&&c&&(c[0]||c[1])){var m=s([c[0]*i[0],c[1]*i[1],0],l);h=r.thenMove(h,m),c=null}return{transform:h,opacity:p,origin:u,align:c,nextSizeTransform:l}}function s(t,e){return[t[0]*e[0]+t[1]*e[4]+t[2]*e[8],t[0]*e[1]+t[1]*e[5]+t[2]*e[9],t[0]*e[2]+t[1]*e[6]+t[2]*e[10]]}var r=t("../../core/Transform"),o={OPACITY:1,TRANSFORM:r.identity,ORIGIN:null,ALIGN:null};i.exports=n}),i("samsara/core/algebras/size",["require","exports","module"],function(t,e,i){function n(t,e){if(!t)return e;var i=new Array(2);return t.size instanceof Function?i=t.size(e):t.size instanceof Array&&(void 0===t.size[0]&&(i[0]=e[0]),void 0===t.size[1]&&(i[1]=e[1]),"number"==typeof t.size[0]&&(i[0]=t.size[0]),"number"==typeof t.size[1]&&(i[1]=t.size[1]),t.size[0]===!0&&(i[0]=!0),t.size[1]===!0&&(i[1]=!0)),t.proportions&&("number"==typeof t.proportions[0]&&(i[0]=t.proportions[0]*e[0]),"number"==typeof t.proportions[1]&&(i[1]=t.proportions[1]*e[1])),t.aspectRatio&&("number"==typeof i[0]?i[1]=t.aspectRatio*i[0]:"number"==typeof i[1]&&(i[0]=t.aspectRatio*i[1])),void 0===i[0]&&(i[0]=e[0]),void 0===i[1]&&(i[1]=e[1]),t.margins&&(i[0]-=2*t.margins[0],i[1]-=2*t.margins[1]),i}i.exports=n}),i("samsara/core/nodes/RenderTreeNode",["require","exports","module","../../events/EventHandler","../../streams/SimpleStream","../../streams/Stream","./LayoutNode","./SizeNode","../algebras/layout","../algebras/size","../../core/queues/preTickQueue","../../core/queues/dirtyQueue"],function(t,e,i){function n(t){this._layout=new u,this._size=new u,this._logic=new u,this.size=new c,this.layout=new c,t?a.call(this,t):(this.layout.subscribe(this._layout),this.size.subscribe(this._size)),this._cachedSpec={layout:null,size:null},this.size.on("start",r.bind(this)),this.size.on("update",r.bind(this)),this.size.on("end",r.bind(this)),this.layout.on("start",s.bind(this)),this.layout.on("update",s.bind(this)),this.layout.on("end",s.bind(this)),this.root=null,this._logic.on("mount",function(t){this.root=t}.bind(this)),this._logic.on("unmount",function(){this.root=null}.bind(this))}function s(t){this._cachedSpec.layout=t}function r(t){this._cachedSpec.size=t}function o(t){var e={},i={},n=!1,s=!1,r=this;for(var o in t)l.KEYS[o]?(e[o]=t[o],n=!0):h.KEYS[o]&&(i[o]=t[o],s=!0);if(n&&i.align){var a=new h({align:i.align});delete i.align,r=r.add(a)}return n&&(r=r.add(new l(e))),s&&(r=r.add(new h(i))),r}function a(t){if(t instanceof l){var e=p.lift(function(t,e){return e?t?f(t,e):e:!1}.bind(this),[t,this._size]);this.size.subscribe(e),this.layout.subscribe(this._layout)}else if(t instanceof h){var i=p.lift(function(t,e,i){return e&&i?t?d(t,e,i):e:!1}.bind(this),[t,this._layout,this._size]);this.layout.subscribe(i),this.size.subscribe(this._size)}else this._logic.on("unmount",function(){t.remove()}.bind(this)),this._logic.on("mount",function(e){t.setup(e.allocator)}.bind(this)),t.on("recall",function(){t._size.unsubscribe(this._size),t._layout.unsubscribe(this._layout)}.bind(this)),t.on("deploy",function(){t._size.subscribe(this._size),t._layout.subscribe(this._layout)}.bind(this))}var u=t("../../events/EventHandler"),c=t("../../streams/SimpleStream"),p=t("../../streams/Stream"),h=t("./LayoutNode"),l=t("./SizeNode"),d=t("../algebras/layout"),f=t("../algebras/size"),m=t("../../core/queues/preTickQueue"),v=t("../../core/queues/dirtyQueue");n.prototype.add=function(t){var e;if(t.constructor===Object)return o.call(this,t);if(t._onAdd)return t._onAdd(this);if(e=t instanceof n?t:new n(t),e._layout.subscribe(this.layout),e._size.subscribe(this.size),e._logic.subscribe(this._logic),this.root&&!e.root&&e._logic.trigger("mount",this.root),!t.root){var i=this;m.push(function(){i._cachedSpec.size&&(i.size.trigger("start",i._cachedSpec.size),i.layout.trigger("start",i._cachedSpec.layout),v.push(function(){i.size.trigger("end",i._cachedSpec.size),i.layout.trigger("end",i._cachedSpec.layout)}))})}return e},n.prototype.remove=function(){this._logic.trigger("unmount"),this._layout.unsubscribe(),this._size.unsubscribe(),this._logic.unsubscribe()},i.exports=n}),i("samsara/core/nodes/RootNode",["require","exports","module","./RenderTreeNode"],function(t,e,i){function n(t){this.allocator=null,s.call(this),t&&this.setAllocator(t)}var s=t("./RenderTreeNode");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.setAllocator=function(t){this.allocator=t,this._logic.trigger("mount",this)},n.prototype.remove=function(){this.allocator=null,s.prototype.remove.apply(this,arguments)},i.exports=n}),i("samsara/transitions/_Transition",["require","exports","module","../events/EventHandler","../streams/SimpleStream"],function(t,e,i){function n(t,e){r.call(this),this.value=t||0,this.velocity=e||0,this.start=t,this.end=0,this.energy=Number.NaN,this._previousTime=Number.NaN,this._active=!1,this._eventOutput=new s,s.setOutputHandler(this,this._eventOutput)}var s=t("../events/EventHandler"),r=t("../streams/SimpleStream");n.DIMENSIONS=1,n.DEFAULT_OPTIONS={},n.prototype=Object.create(r.prototype),n.prototype.constructor=n,n.prototype.set=function(t,e){this._active||(this.emit("start",this.get()),this._active=!0),this.start=this.get(),this.end=t,e&&e.velocity?this.velocity=e.velocity:this.velocity=this.velocity||0,this._previousTime=Date.now()},n.prototype.get=function(){return this.value},n.prototype.getVelocity=function(){return this.velocity},n.prototype.reset=function(t,e){this.start=t,this.value=t,this.velocity=e||0},n.prototype.halt=function(){if(this._active){this._active=!1;var t=this.get();this.reset(t),this.emit("end",t)}},n.prototype.isActive=function(){return this._active},n.prototype.update=function(){},i.exports=n}),i("samsara/transitions/_Tween",["require","exports","module","./_Transition","../core/queues/dirtyQueue"],function(t,e,i){function n(t){c.apply(this,arguments),this._curve=void 0,this._duration=0}function s(t){var e=d[t];if(void 0!==e)return e;throw new Error("curve not registered")}function r(t,e,i){var n;if(t instanceof Array){n=[];for(var s=0;s<t.length;s++)"number"==typeof t[s]?n.push(o(t[s],e[s],i)):n.push(t[s])}else n=o(t,e,i);return n}function o(t,e,i){return(1-i)*t+i*e}function a(t,e,i,n,s){return(t-e)*(i(s+l)-i(s-l))/(2*l*n)}function u(t,e,i,n,s){var r;if(t instanceof Array){r=[];for(var o=0;o<t.length;o++)"number"==typeof t[o]?r.push(a(t[o],e[o],i,n,s)):r.push(t[o])}else r=a(t,e,i,n,s);return r}var c=t("./_Transition"),p=t("../core/queues/dirtyQueue"),h=Date.now,l=1e-9,d={};n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.CURVES={linear:function(t){return t},easeIn:function(t){return t*t},easeOut:function(t){return t*(2-t)},easeInOut:function(t){return.5>=t?2*t*t:-2*t*t+4*t-1},easeOutBounce:function(t){return t*(3-2*t)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1+Math.pow(t-1,3)},easeInOutCubic:function(t){return t*=2,1>t?.5*t*t*t:.5*Math.pow(t-2,3)+1},easeOutWall:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},n.DIMENSIONS=1/0,n.DEFAULT_OPTIONS={curve:n.CURVES.linear,duration:500},n.register=function(t,e){return d[t]?!1:(d[t]=e,!0)},n.deregister=function(t){return d[t]?(delete d[t],!0):!1},n.getCurves=function(){return d},n.prototype.set=function(t,e){c.prototype.set.apply(this,arguments);var i=e.curve;!d[i]&&n.CURVES[i]&&n.register(i,n.CURVES[i]),this._duration=e.duration||n.DEFAULT_OPTIONS.duration,this._curve=i?i instanceof Function?i:s(i):n.DEFAULT_OPTIONS.curve},n.prototype.update=function(){if(this._active){var t=h()-this._previousTime;if(this.velocity=u(this.state,this.start,this._curve,this._duration,1),t<this._duration){var e=t/this._duration;this.value=r(this.start,this.end,this._curve(e)),this.emit("update",this.value)}else this.emit("update",this.end),p.push(function(){this.reset(this.end),this._active=!1,this.emit("end",this.end)}.bind(this))}},i.exports=n}),i("samsara/transitions/_Spring",["require","exports","module","./_Transition","../core/queues/dirtyQueue"],function(t,e,i){function n(t,e){p.apply(this,arguments),this.curve=null,this.energyTolerance=f}function s(t,e){return Math.max(1,Math.abs(e-t))}function r(t,e,i,n,s){return 1>t?a(t,e,i,n,s):1===t?u(t,e,i,n,s):c(t,e,i,n,s)}function o(t){var e=2*Math.PI/t;return function(t,i,n){var s=t-i,r=e*e*s*s,o=n*n;return o+r}}function a(t,e,i,n,s){var r=Math.sqrt(1-t*t)/e,o=i-n,a=(t/e*o+s)/r;return function(i){return n+Math.exp(-t*i/e)*(o*Math.cos(r*i)+a*Math.sin(r*i))}}function u(t,e,i,n,s){var r=i-n,o=s+r/e;return function(i){return n+Math.exp(-t*i/e)*(r+o*i)}}function c(t,e,i,n,s){var r=Math.sqrt(t*t-1)/e,o=-t/e+r,a=-t/e-r,u=i-n,c=(o*u-s)/(a-o),p=u+c,h=-c;return function(t){return n+p*Math.exp(o*t)+h*Math.exp(a*t)}}var p=t("./_Transition"),h=t("../core/queues/dirtyQueue"),l=Date.now,d=1e-6,f=1e-9;n.DIMENSIONS=1,n.DEFAULT_OPTIONS={velocity:0,damping:.5,period:100},n.prototype=Object.create(p.prototype),n.prototype.constructor=n,n.prototype.set=function(t,e){p.prototype.set.apply(this,arguments);var i=e.damping||n.DEFAULT_OPTIONS.damping,a=e.period||n.DEFAULT_OPTIONS.period;this.curve=r(i,a,this.start,this.end,this.velocity),this.energy=o(a);var u=s(this.end,this.start);this.energyTolerance=f*Math.pow(u,2)},n.prototype.update=function(){if(this._active){var t=l()-this._previousTime;this.value=this.curve(t);var e=this.curve(t+d),i=this.curve(t-d);this.velocity=(e-i)/(2*d);var n=this.energy(this.end,this.value,this.velocity);n>=this.energyTolerance?this.emit("update",this.value):(this.emit("update",this.end),h.push(function(){this.reset(this.end),this._active=!1,this.emit("end",this.end)}.bind(this)))}},i.exports=n}),i("samsara/transitions/_Inertia",["require","exports","module","./_Transition","../core/queues/dirtyQueue"],function(t,e,i){function n(t,e){s.apply(this,arguments),this.drag=0}var s=t("./_Transition"),r=t("../core/queues/dirtyQueue"),o=Date.now,a=1e-4;n.DIMENSIONS=1,n.DEFAULT_OPTIONS={velocity:0,drag:.1},n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.set=function(t,e){s.prototype.set.apply(this,arguments),this.drag=void 0===e.drag?n.DEFAULT_OPTIONS.drag:Math.pow(Math.min(e.drag,1),3);
},n.prototype.update=function(){if(this._active){var t=o(),e=t-this._previousTime;this._previousTime=t,this.velocity*=1-this.drag,this.value+=e*this.velocity;var i=.5*this.velocity*this.velocity;i>=a?this.emit("update",this.value):(this.emit("update",this.value),r.push(function(){this.reset(this.value),this._active=!1,this.emit("end",this.value)}.bind(this)))}},i.exports=n}),i("samsara/transitions/_Damp",["require","exports","module","./_Transition","../core/queues/dirtyQueue"],function(t,e,i){function n(t,e){s.apply(this,arguments),this.damp=0}var s=t("./_Transition"),r=t("../core/queues/dirtyQueue"),o=Date.now,a=1e-6;n.DIMENSIONS=1,n.DEFAULT_OPTIONS={damping:.9},n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.set=function(t,e){s.prototype.set.apply(this,arguments),this.damp=void 0===e.damping?n.DEFAULT_OPTIONS.damping:e.damping},n.prototype.update=function(){if(this._active){var t=o(),e=t-this._previousTime;this._previousTime=t;var i=this.value*this.damp;this.velocity=1/e*(this.value-i),this.value=i;var n=.5*this.value*this.value;n>=a?this.emit("update",this.value):(this.emit("update",this.value),r.push(function(){this.reset(this.value),this._active=!1,this.emit("end",this.value)}.bind(this)))}},i.exports=n}),i("samsara/transitions/_Immediate",["require","exports","module","./_Transition","../core/queues/dirtyQueue"],function(t,e,i){function n(t){s.apply(this,arguments)}var s=t("./_Transition"),r=t("../core/queues/dirtyQueue");n.DIMENSIONS=1/0,n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.set=function(t){this.value=t,s.prototype.set.apply(this,arguments),r.push(function(){this.emit("end",this.value)}.bind(this))},i.exports=n}),i("samsara/core/Transitionable",["require","exports","module","./queues/preTickQueue","./queues/dirtyQueue","./queues/tickQueue","../events/EventHandler","../streams/SimpleStream","../streams/Stream","../transitions/_Tween","../transitions/_Spring","../transitions/_Inertia","../transitions/_Damp","../transitions/_Immediate"],function(t,e,i){function n(t){this._callback=void 0,this._method=null,this._active=!1,this._currentActive=!1,this.updateMethod=void 0,this._eventInput=new u,this._eventOutput=new u,u.setInputHandler(this,this._eventInput),u.setOutputHandler(this,this._eventOutput);var e=!1;this._eventInput.on("start",function(t){e=!1,this._currentActive=!0,this._active||(this.emit("start",t),this._active=!0)}.bind(this)),this._eventInput.on("update",function(t){e=!0,this.emit("update",t)}.bind(this)),this._eventInput.on("end",function(t){if(this._currentActive=!1,this._callback){var i=this._callback;this._callback=void 0,i()}this._currentActive||(e=!1,this._active=!1,this.emit("end",t))}.bind(this)),void 0!==t&&(this.value=t,r.push(function(){this.trigger("start",t),o.push(function(){e||this.trigger("end",t)}.bind(this))}.bind(this)))}function s(t,e){this._eventOutput=new u,u.setOutputHandler(this,this._eventOutput),this.sources=[];for(var i=0;i<t.length;i++){var n=new e(t[i]);this.sources.push(n)}this.stream=p.merge(this.sources),this._eventOutput.subscribe(this.stream)}var r=t("./queues/preTickQueue"),o=t("./queues/dirtyQueue"),a=t("./queues/tickQueue"),u=t("../events/EventHandler"),c=t("../streams/SimpleStream"),p=t("../streams/Stream"),h=t("../transitions/_Tween"),l=t("../transitions/_Spring"),d=t("../transitions/_Inertia"),f=t("../transitions/_Damp"),m=t("../transitions/_Immediate"),v={tween:h,spring:l,inertia:d,damp:f};n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.register=function(t,e){t in v||(v[t]=e)},n.unregister=function(t){return t in v?(delete v[t],!0):!1},n.prototype.set=function(t,e,i){var n;if(e&&0!==e.duration){i&&(this._callback=i);var r=e.curve;n=r&&v[r]?v[r]:h}else this.value=t,i&&o.push(i),n=m;if(this._method!==n){if(this._interpolant){if(this.updateMethod){var u=a.indexOf(this.updateMethod);u>=0&&a.splice(u,1)}this.unsubscribe(this._interpolant)}t instanceof Array?this._interpolant=t.length<n.DIMENSIONS?new n(this.get()):new s(this.get(),n):this._interpolant=new n(this.get()),this.subscribe(this._interpolant),this._interpolant.update&&(this.updateMethod=this._interpolant.update.bind(this._interpolant),a.push(this.updateMethod)),this._method=n}this._interpolant.set(t,e)},n.prototype.get=function(){return this._interpolant?this._interpolant.get():this.value},n.prototype.getVelocity=function(){return this._interpolant&&this._interpolant.getVelocity?this._interpolant.getVelocity():void 0},n.prototype.reset=function(t,e){this._callback=null,this._method=null,this.value=t,this._interpolant&&this._interpolant.reset(t,e)},n.prototype.halt=function(){if(this._active){var t=this.get();if(this.reset(t),this.trigger("end",t),this._interpolant){if(this.updateMethod){var e=a.indexOf(this.updateMethod);e>=0&&a.splice(e,1)}this.unsubscribe(this._interpolant)}}},n.prototype.isActive=function(){return this._active},n.prototype.setMany=function(t,e){var i=t.shift();0===t.length?this.set(i[0],i[1],e):this.set(i[0],i[1],this.setMany.bind(this,t,e))},n.prototype.loop=function(t){var e=t.slice(0);this.setMany(t,this.loop.bind(this,e))},n.prototype.delay=function(t,e){this.set(this.get(),{duration:e,curve:function(){return 0}},t)},s.prototype.set=function(t,e){for(var i=e&&e.velocity?e.velocity.slice():void 0,n=0;n<t.length;n++)i&&(e.velocity=i[n]),this.sources[n].set(t[n],e)},s.prototype.get=function(){return this.sources.map(function(t){return t.get()})},s.prototype.getVelocity=function(){return this.sources.map(function(t){return t.getVelocity()})},s.prototype.update=function(){for(var t=0;t<this.sources.length;t++)this.sources[t].update()},s.prototype.reset=function(t){for(var e=0;e<this.sources.length;e++){var i=this.sources[e];i.reset(t[e])}},i.exports=n}),i("samsara/core/_OptionsManager",["require","exports","module","../events/EventHandler"],function(t,e,i){function n(t){this._value=t,this._eventHandler=null}function s(){this._eventHandler||(this._eventHandler=new o)}function r(t){var e;if("object"==typeof t){e=t instanceof Array?[]:{};for(var i in t){var n=t[i];if("object"==typeof n&&null!==n)if(n instanceof Array){e[i]=[];for(var s=0;s<n.length;s++)e[i][s]=r(n[s])}else e[i]=r(n);else e[i]=n}}else e=t;return e}var o=t("../events/EventHandler");n.patch=function(t,e){for(var i=new n(t),s=1;s<arguments.length;s++)i.patch(arguments[s]);return t},n.setOptions=function(t,e,i){i=i||r(t.constructor.DEFAULT_OPTIONS)||{};var s=new n(i);return t.setOptions=n.prototype.setOptions.bind(s),t.getOptions=n.prototype.getOptions.bind(s),e&&t.setOptions(e),s.get()},n.prototype.patch=function(t){var e=this._value;for(var i in t)i in e&&t[i]&&t[i].constructor===Object&&e[i]&&e[i].constructor===Object?(e.hasOwnProperty(i)||(e[i]=Object.create(e[i])),this.key(i).patch(t[i]),this._eventHandler&&this._eventHandler.emit("change",{key:i,value:this.key(i).value()})):this.set(i,t[i]);return this},n.prototype.setOptions=n.prototype.patch,n.prototype.key=function a(a){var t=new n(this._value[a]);return(!(t._value instanceof Object)||t._value instanceof Array)&&(t._value={}),t},n.prototype.get=function(t){return t?this._value[t]:this._value},n.prototype.getOptions=n.prototype.get,n.prototype.set=function(t,e){var i=this.get(t);return this._value[t]=e,this._eventHandler&&e!==i&&this._eventHandler.emit("change",{key:t,value:e}),this},n.prototype.on=function(t,e){s.call(this),o.prototype.on.apply(this._eventHandler,arguments)},n.prototype.off=function(t,e){s.call(this),o.prototype.off.apply(this._eventHandler,arguments)},i.exports=n}),i("samsara/dom/Context",["require","exports","module","./_DOMAllocator","../core/Engine","../core/nodes/RootNode","../core/Transitionable","../core/_OptionsManager","../streams/SimpleStream","../events/EventHandler"],function(t,e,i){function n(t){function e(t){var e=t.type;return"touchstart"===e&&(i=!0),i&&"m"===e[0]?("mouseup"===e&&(i=!1),!1):!0}this.options=c.setOptions(this,t,n.DEFAULT_OPTIONS),this._node=new a,this._size=new p,this._layout=new p,this._cachedSize=[],this.size=this._size.map(function(t){if("end"===t)return this._cachedSize;var e=this.container.clientWidth,i=this.container.clientHeight;return e!==this._cachedSize[0]||i!==this._cachedSize[1]?(this._cachedSize[0]=e,this._cachedSize[1]=i,this.emit("resize",this._cachedSize),[e,i]):!1}.bind(this)),this._perspective=new u,this._perspectiveOrigin=new u,this.perspectiveFrom(this._perspective),this.perspectiveOriginFrom(this._perspectiveOrigin),this._eventOutput=new h,this._eventForwarder=function(t){t.stopPropagation();var i=e.call(this,t);i&&this._eventOutput.emit(t.type,t)}.bind(this);var i=!1;this.options.enableScroll===!1&&this.on("deploy",function(t){t.addEventListener("touchmove",function(t){t.preventDefault()},!1)})}function s(t){return 100*t[0]+"% "+100*t[1]+"%"}var r=t("./_DOMAllocator"),o=t("../core/Engine"),a=t("../core/nodes/RootNode"),u=t("../core/Transitionable"),c=t("../core/_OptionsManager"),p=t("../streams/SimpleStream"),h=t("../events/EventHandler");n.prototype.elementClass="samsara-context",n.DEFAULT_OPTIONS={enableScroll:!1},n.prototype.add=function(){return a.prototype.add.apply(this._node,arguments)},n.prototype.remove=function(){if(this.elementClass instanceof Array)for(var t=0;t<this.elementClass.length;t++)this.container.classList.remove(this.elementClass[t]);else this.container.classList.remove(this.elementClass);for(this._node.remove();this.container.hasChildNodes();)this.container.removeChild(this.container.firstChild);o.deregisterContext(this)},n.prototype.perspectiveFrom=function(t){this._perspective=t,this._perspective.on("update",function(t){d(this.container,t)}.bind(this)),this._perspective.on("end",function(t){d(this.container,t)}.bind(this))},n.prototype.perspectiveOriginFrom=function(t){this._perspectiveOrigin=t,this._perspectiveOrigin.on("update",function(t){f(this.container,t)}.bind(this)),this._perspectiveOrigin.on("end",function(t){f(this.container,t)}.bind(this))},n.prototype.getPerspective=function(){return this._perspective.get()},n.prototype.setPerspective=function(t,e,i){this.container?this._perspective.set(t,e,i):this.on("deploy",function(){this._perspective.set(t,e,i)}.bind(this))},n.prototype.setPerspectiveOrigin=function(t,e,i){this.container?this._perspectiveOrigin.set(t,e,i):this.on("deploy",function(){this._perspectiveOrigin.set(t,e,i)}.bind(this))},n.prototype.mount=function(t){if(t=t||window.document.body,this.container=t,this.elementClass instanceof Array)for(var e=0;e<this.elementClass.length;e++)this.container.classList.add(this.elementClass[e]);else this.container.classList.add(this.elementClass);var i=new r(this.container);this._node.setAllocator(i),this._node._size.subscribe(this.size),this._node._layout.subscribe(this._layout),this.emit("deploy",this.container),o.registerContext(this)},n.prototype.on=function(t,e){this.container?this.container.addEventListener(t,this._eventForwarder):this._eventOutput.on("deploy",function(e){e.addEventListener(t,this._eventForwarder)}.bind(this)),h.prototype.on.apply(this._eventOutput,arguments)},n.prototype.off=function(t,e){h.prototype.off.apply(this._eventOutput,arguments)},n.prototype.emit=function(t,e){h.prototype.emit.apply(this._eventOutput,arguments)};var l=!("perspective"in window.document.documentElement.style),d=l?function(t,e){t.style.webkitPerspective=e?(0|e)+"px":"0px"}:function(t,e){t.style.perspective=e?(0|e)+"px":"0px"},f=l?function(t,e){t.style.webkitPerspectiveOrigin=e?s(e):"50% 50%"}:function(t,e){t.style.perspectiveOrigin=e?s(e):"50% 50%"};i.exports=n}),i("samsara/dom/_DOMOutput",["require","exports","module","../core/Transform"],function(t,e,i){function n(){this._cachedSpec={},this._opacityDirty=!0,this._originDirty=!0,this._transformDirty=!0,this._isVisible=!0,this._roundToPixel=!1}function s(t,e){return 1===e?Math.round(t):Math.round(t*e)/e}function r(t,e){for(var i=y,n=0;15>n;n++)Math.abs(t[n])<m&&(t[n]=0),i+=12===n||13===n?s(t[n],e)+_:t[n]+_;return i+t[15]+g}function o(t){return 100*t[0]+"% "+100*t[1]+"%"}function a(t,e){return t&&e?t[0]!==e[0]||t[1]!==e[1]:t!==e}function u(t,e){e[0]===!0?e[0]=t.offsetWidth:e[0]>=0&&(t.style.width=e[0]+b),e[1]===!0?e[1]=t.offsetHeight:e[1]>=0&&(t.style.height=e[1]+b)}function c(t,e){!this._isVisible&&e>d&&(t.style.pointerEvents="auto",this._isVisible=!0),e>f?e=f:d>e&&(e=d,this._isVisible&&(t.style.pointerEvents="none",this._isVisible=!1)),t.style.opacity=e}var p=t("../core/Transform"),h=!("transform"in window.document.documentElement.style),l=2*(window.devicePixelRatio||1),d=1e-4,f=.9999,m=1e-5,v=[0,0],y="matrix3d(",_=",",g=")",b="px",O=h?function(t,e){t.style.webkitTransformOrigin=o(e)}:function(t,e){t.style.transformOrigin=o(e)},T=h?function(t,e,i){t.style.webkitTransform=r(e,i)}:function(t,e,i){t.style.transform=r(e,i)};n.prototype.querySelector=function(t,e){return t.querySelector(e)},n.prototype.querySelectorAll=function(t,e){return t.querySelectorAll(e)},n.prototype.applyClasses=function(t,e){for(var i=0;i<e.length;i++)t.classList.add(e[i])},n.prototype.applyProperties=function(t,e){for(var i in e)t.style[i]=e[i]},n.prototype.applyAttributes=function(t,e){for(var i in e)t.setAttribute(i,e[i])},n.prototype.removeClasses=function(t,e){for(var i=0;i<e.length;i++)t.classList.remove(e[i])},n.prototype.removeProperties=function(t,e){for(var i in e)t.style[i]=""},n.prototype.removeAttributes=function(t,e){for(var i in e)t.removeAttribute(i)},n.prototype.on=function(t,e,i){t.addEventListener(e,i)},n.prototype.off=function(t,e,i){t.removeEventListener(e,i)},n.prototype.applyContent=function(t,e){if(e instanceof Node){for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}else t.innerHTML=e},n.prototype.recallContent=function(t){for(var e=document.createDocumentFragment();t.hasChildNodes();)e.appendChild(t.firstChild);return e},n.prototype.makeVisible=function(t){t.style.display="",this._cachedSize&&(this._cachedSize[0]===!0&&(t.style.width="auto"),this._cachedSize[1]===!0&&(t.style.height="auto"))},n.prototype.makeInvisible=function(t){t.style.display="none",t.style.opacity="",t.style.width="",t.style.height="",h?(t.style.webkitTransform="",t.style.webkitTransformOrigin=""):(t.style.transform="",t.style.transformOrigin=""),this._cachedSpec={}},n.prototype.commitLayout=function(t,e){var i=this._cachedSpec,n=e.transform||p.identity,s=void 0===e.opacity?1:e.opacity,r=e.origin||v;this._transformDirty=p.notEquals(i.transform,n),this._opacityDirty=this._opacityDirty||i.opacity!==s,this._originDirty=this._originDirty||r&&a(i.origin,r),this._opacityDirty&&(i.opacity=s,c.call(this,t,s)),this._originDirty&&(i.origin=r,O(t,r)),this._transformDirty&&(i.transform=n,T(t,n,this._roundToPixel?1:l)),this._originDirty=!1,this._transformDirty=!1,this._opacityDirty=!1},n.prototype.commitSize=function(t,e){return e[0]!==!0&&(e[0]=s(e[0],l)),e[1]!==!0&&(e[1]=s(e[1],l)),a(this._cachedSpec.size,e)?(this._cachedSpec.size=e,u(t,e),!0):!1},n.prototype.promoteLayer=function(t){t.style.willChange="transform, opacity"},n.prototype.demoteLayer=function(t){t.style.willChange="auto"},i.exports=n}),i("samsara/dom/Surface",["require","exports","module","./_DOMOutput","../events/EventHandler","../streams/Stream","../core/nodes/SizeNode","../core/nodes/LayoutNode","../core/algebras/size","../core/algebras/layout","../core/queues/dirtyQueue"],function(t,e,i){function n(t){function e(t){var e=t.type;return"touchstart"===e&&(i=!0),i&&"m"===e[0]?("mouseup"===e&&(i=!1),!1):!0}this.properties={},this.attributes={},this.classList=[],this.content="",this._cachedSize=null,this._allocator=null,this._currentTarget=null,this._elementOutput=new o,this._eventOutput=new a,a.setOutputHandler(this,this._eventOutput),this._eventForwarder=function(t){t.stopPropagation();var i=e.call(this,t);i&&this._eventOutput.emit(t.type,t)}.bind(this);var i=!1;this._sizeNode=new c,this._layoutNode=new p,this._size=new a,this._layout=new a,this.size=u.lift(function(t,e){return e?h(t,e):!1},[this._sizeNode,this._size]),this.layout=u.lift(function(t,e,i){return t&&i?e?l(e,t,i):t:!1},[this._layout,this._layoutNode,this.size]),this.layout.on("start",function(){this._currentTarget&&this._elementOutput.promoteLayer(this._currentTarget)}.bind(this)),this.layout.on("update",function(t){this._currentTarget&&this._elementOutput.commitLayout(this._currentTarget,t)}.bind(this)),this.layout.on("end",function(t){this._currentTarget&&(this._elementOutput.commitLayout(this._currentTarget,t),this._elementOutput.demoteLayer(this._currentTarget))}.bind(this)),this.size.on("start",s.bind(this)),this.size.on("update",s.bind(this)),this.size.on("end",s.bind(this)),t&&this.setOptions(t)}function s(t){if(this._currentTarget){var e=this._elementOutput.commitSize(this._currentTarget,t);this._cachedSize=t,e&&this.emit("resize",t)}}function r(){this.addClass("samsara-scrollable"),f&&this.on("deploy",function(t){m&&t.addEventListener("touchstart",function(){var e=t.scrollTop,i=t.offsetHeight,n=t.scrollHeight;0===e?t.scrollTop=1:e+i===n&&(t.scrollTop=n-i-1)},!1),t.addEventListener("touchmove",function(t){t.stopPropagation()},!1)})}var o=t("./_DOMOutput"),a=t("../events/EventHandler"),u=t("../streams/Stream"),c=t("../core/nodes/SizeNode"),p=t("../core/nodes/LayoutNode"),h=t("../core/algebras/size"),l=t("../core/algebras/layout"),d=t("../core/queues/dirtyQueue"),f="ontouchstart"in window,m=/iPad|iPhone|iPod/.test(navigator.platform);n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.elementType="div",n.prototype.elementClass="samsara-surface",n.prototype.setContent=function(t){this.content!==t&&(this.content=t,this._currentTarget&&d.push(function(){this._elementOutput.applyContent(this._currentTarget,t)}.bind(this)))},n.prototype.getContent=function(){return this.content},n.prototype.setAttributes=function(t){for(var e in t){var i=t[e];void 0!==i&&(this.attributes[e]=t[e])}this._currentTarget&&d.push(function(){this._elementOutput.applyAttributes(this._currentTarget,t)}.bind(this))},n.prototype.getAttributes=function(){return this.attributes},n.prototype.setProperties=function(t){for(var e in t)this.properties[e]=t[e];this._currentTarget&&d.push(function(){this._elementOutput.applyProperties(this._currentTarget,t)}.bind(this))},n.prototype.getProperties=function(){return this.properties},n.prototype.addClass=function(t){this.classList.indexOf(t)<0&&(this.classList.push(t),this._currentTarget&&d.push(function(){this._elementOutput.applyClasses(this._currentTarget,this.classList)}.bind(this)))},n.prototype.removeClass=function(t){var e=this.classList.indexOf(t);e>=0&&(this.classList.splice(e,1),this._currentTarget&&d.push(function(){this._elementOutput.removeClasses(this._currentTarget,this.classList)}.bind(this)))},n.prototype.toggleClass=function(t){var e=this.classList.indexOf(t);-1===e?this.addClass(t):this.removeClass(t)},n.prototype.setClasses=function(t){for(var e=0;e<t.length;e++)this.addClass(t[e])},n.prototype.getClassList=function(){return this.classList},n.prototype.querySelector=function(t){return this._currentTarget?this._elementOutput.querySelector(this._currentTarget,t):void 0},n.prototype.querySelectorAll=function(t){return this._currentTarget?this._elementOutput.querySelectorAll(this._currentTarget,t):void 0},n.prototype.setOptions=function(t){void 0!==t.tagName&&(this.elementType=t.tagName),void 0!==t.opacity&&this.setOpacity(t.opacity),void 0!==t.size&&this.setSize(t.size),void 0!==t.origin&&this.setOrigin(t.origin),void 0!==t.proportions&&this.setProportions(t.proportions),void 0!==t.margins&&this.setMargins(t.margins),void 0!==t.classes&&this.setClasses(t.classes),void 0!==t.properties&&this.setProperties(t.properties),void 0!==t.attributes&&this.setAttributes(t.attributes),void 0!==t.content&&this.setContent(t.content),void 0!==t.aspectRatio&&this.setAspectRatio(t.aspectRatio),t.enableScroll&&r.call(this),t.roundToPixel&&(this._elementOutput._roundToPixel=t.roundToPixel)},n.prototype.on=function(t,e){this._currentTarget&&this._elementOutput.on(this._currentTarget,t,this._eventForwarder),a.prototype.on.apply(this._eventOutput,arguments)},n.prototype.once=function(t,e){this._currentTarget&&this._elementOutput.once(this._currentTarget,t,this._eventForwarder),a.prototype.once.apply(this._eventOutput,arguments)},n.prototype.off=function(t,e){this._currentTarget&&this._elementOutput.off(this._currentTarget,t,this._eventForwarder),a.prototype.off.apply(this._eventOutput,arguments)},n.prototype.setup=function(t){if(!this._currentTarget){this._allocator=t;var e=t.allocate(this.elementType);if(this._currentTarget=e,this.elementClass)if(this.elementClass instanceof Array)for(var i=0;i<this.elementClass.length;i++)this.addClass(this.elementClass[i]);else this.addClass(this.elementClass);for(var n in this._eventOutput.listeners)this._elementOutput.on(e,n,this._eventForwarder);this.deploy(this._currentTarget)}},n.prototype.remove=function(){var t=this._currentTarget;if(t){for(var e in this._eventOutput.listeners)this._elementOutput.off(t,e,this._eventForwarder);this.recall(t),this._allocator.deallocate(t),this._allocator=null,this._currentTarget=null}},n.prototype.deploy=function(t){this._elementOutput.makeVisible(t),this._elementOutput.applyClasses(t,this.classList),this._elementOutput.applyProperties(t,this.properties),this._elementOutput.applyAttributes(t,this.attributes),this._elementOutput.applyContent(t,this.content),this._eventOutput.emit("deploy",t)},n.prototype.recall=function(t){this._eventOutput.emit("recall"),this._elementOutput.removeClasses(t,this.classList),this._elementOutput.removeProperties(t,this.properties),this._elementOutput.removeAttributes(t,this.attributes),this.content=this._elementOutput.recallContent(t),this._elementOutput.makeInvisible(t)},n.prototype.getSize=function(){return this._cachedSize},n.prototype.setSize=function(t){this._cachedSize=t,this._sizeNode.set({size:t})},n.prototype.setProportions=function(t){this._sizeNode.set({proportions:t})},n.prototype.setMargins=function(t){this._sizeNode.set({margins:t})},n.prototype.setAspectRatio=function(t){this._sizeNode.set({aspectRatio:t})},n.prototype.setOrigin=function(t){this._layoutNode.set({origin:t}),this._elementOutput._originDirty=!0},n.prototype.setOpacity=function(t){this._layoutNode.set({opacity:t}),this._elementOutput._opacityDirty=!0},i.exports=n}),i("samsara/dom/ContainerSurface",["require","exports","module","./Surface","./Context"],function(t,e,i){function n(t){s.call(this,t),this.context=new r,this.context.elementClass=n.prototype.elementClass,this.context._size.subscribe(this.size),this.on("deploy",function(t){this.context.mount(t)}.bind(this)),this.on("recall",function(){this.context.remove()}.bind(this))}var s=t("./Surface"),r=t("./Context");n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.elementType="div",n.prototype.elementClass=["samsara-surface","samsara-container"],n.prototype.getPerspective=function(){return r.prototype.getPerspective.apply(this.context,arguments)},n.prototype.setPerspective=function(){r.prototype.setPerspective.apply(this.context,arguments)},n.prototype.add=function(){return r.prototype.add.apply(this.context,arguments)},n.prototype.remove=function(){s.prototype.remove.apply(this,arguments)},i.exports=n}),i("samsara/core/Controller",["require","exports","module","./_OptionsManager","../events/EventHandler","../streams/SimpleStream"],function(t,e,i){function n(t){this.options=s(this.constructor.DEFAULT_OPTIONS||n.DEFAULT_OPTIONS),this._optionsManager=new a(this.options),t&&this.setOptions(t),this.input=new c,this.output=new c,u.setInputHandler(this,this.input),u.setOutputHandler(this,this.output),r.call(this,this.constructor.EVENTS||n.EVENTS,this.input),this.input.bindThis(this),this.input.subscribe(this._optionsManager),this.initialize&&this.initialize(this.options)}function s(t){var e;if("object"==typeof t){e=t instanceof Array?[]:{};for(var i in t){var n=t[i];if("object"==typeof n&&null!==n)if(n instanceof Array){e[i]=[];for(var r=0;r<n.length;r++)e[i][r]=s(n[r])}else e[i]=s(n);else e[i]=n}}else e=t;return e}function r(t,e){for(var i in t){var n=t[i],s="string"==typeof n?this[n]:n;s&&e.on(i,s.bind(this))}}function o(t,e){var i=this,n=t.hasOwnProperty("constructor")?function(){t.constructor.apply(this,arguments)}:function(){i.apply(this,arguments)};n.extend=o,n.prototype=Object.create(i.prototype),n.prototype.constructor=n;for(var s in t){var r=t[s];switch(s){case p.DEFAULTS:n.DEFAULT_OPTIONS=r;break;case p.EVENTS:if(n.EVENTS)for(var a in r)n.EVENTS[a]=r[a];else n.EVENTS=r;break;default:n.prototype[s]=r}}for(s in e)n[s]=e[s];return n}var a=t("./_OptionsManager"),u=t("../events/EventHandler"),c=t("../streams/SimpleStream");n.DEFAULT_OPTIONS={},n.EVENTS={},n.prototype.getOptions=function(t){return a.prototype.getOptions.apply(this._optionsManager,arguments)},n.prototype.setOptions=function(){a.prototype.setOptions.apply(this._optionsManager,arguments)};var p={DEFAULTS:"defaults",EVENTS:"events"};n.extend=o,i.exports=n}),i("samsara/core/View",["require","exports","module","./Controller","./nodes/RenderTreeNode","./nodes/SizeNode","./nodes/LayoutNode"],function(t,e,i){function n(t){(this._cachedSize[0]!==t[0]||this._cachedSize[1]!==t[1])&&(this._cachedSize=t,this.emit("resize",t))}function s(t){for(var e in t){var i=t[e];switch(e){case"size":this.setSize(i);break;case"proportions":this.setProportions(i);break;case"margins":this.setMargins(i);break;case"aspectRatio":this.setAspectRatio(i);break;case"origin":this.setOrigin(i);break;case"opacity":this.setOpacity(i)}}}var r=t("./Controller"),o=t("./nodes/RenderTreeNode"),a=t("./nodes/SizeNode"),u=t("./nodes/LayoutNode"),c=r.extend({defaults:{size:null,origin:null,opacity:1},events:{change:s},constructor:function(t){this._sizeNode=new a,this._layoutNode=new u,this._node=new o,this._addNode=this._node.add(this._sizeNode).add(this._layoutNode),this.size=this._addNode.size,this._size=this._node.size,this._cachedSize=[0,0],this.size.on("start",n.bind(this)),this.size.on("update",n.bind(this)),this.size.on("end",n.bind(this)),r.call(this,t),this.options&&s.call(this,this.options)},_onAdd:function(t){return t.add(this._node)},add:function(){return o.prototype.add.apply(this._addNode,arguments)},remove:function(){o.prototype.remove.apply(this._node,arguments)},getSize:function(){return this._cachedSize},setSize:function(t){this._cachedSize=t,this._sizeNode.set({size:t})},setProportions:function(t){this._sizeNode.set({proportions:t})},setMargins:function(t){this._sizeNode.set({margins:t})},setAspectRatio:function(t){this._sizeNode.set({aspectRatio:t})},setOrigin:function(t){this._layoutNode.set({origin:t})},setOpacity:function(t){this._layoutNode.set({opacity:t})}});i.exports=c}),i("samsara/streams/Accumulator",["require","exports","module","../core/_OptionsManager","../streams/Stream","../core/queues/preTickQueue","../core/queues/dirtyQueue"],function(t,e,i){function n(t,e){this.options=r.setOptions(this,e),this.sum=void 0,void 0!==t&&this.set(t),o.call(this,{start:function(){return this.sum||0}.bind(this),update:function(){return this.sum}.bind(this),end:function(){return this.sum||0}.bind(this)}),this._eventInput.on("start",function(t){if(void 0===this.sum)if(t instanceof Array){this.sum=[];for(var e=0;e<t.length;e++)this.sum[e]=s(t[e],this.options.min,this.options.max)}else this.sum=s(t,this.options.min,this.options.max)}.bind(this)),this._eventInput.on("update",function(t){if(t instanceof Array)for(var e=0;e<t.length;e++)this.sum[e]+=t[e],this.sum[e]=s(this.sum[e],this.options.min,this.options.max);else this.sum+=t,this.sum=s(this.sum,this.options.min,this.options.max)}.bind(this))}function s(t,e,i){return Math.min(Math.max(t,e),i)}var r=t("../core/_OptionsManager"),o=t("../streams/Stream"),a=t("../core/queues/preTickQueue"),u=t("../core/queues/dirtyQueue");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={min:-(1/0),max:1/0},n.prototype.set=function(t,e){if(this.sum=t,e!==!0){var i=this;a.push(function(){i.trigger("start",t),u.push(function(){i.trigger("end",t)})})}},n.prototype.get=function(){return this.sum},i.exports=n}),i("samsara/streams/Differential",["require","exports","module","../streams/Stream","../core/_OptionsManager"],function(t,e,i){function n(t){this.options=r.setOptions(this,t);var e=void 0,i=void 0,n=void 0,o=!1;s.call(this,{update:function(){return i}}),this._eventInput.on("start",function(t){o=!1;var i=this.options.scale;if(t instanceof Array){if(void 0!==e){n=[];for(var s=0;s<t.length;s++)n[s]=i*(t[s]-e[s])}e=t.slice()}else void 0!==e&&(n=i*(t-e)),e=t}.bind(this)),this._eventInput.on("update",function(t){o=!0;var n=this.options.scale;if(e instanceof Array){i=[];for(var s=0;s<e.length;s++)i[s]=n*(t[s]-e[s]),e[s]=t[s]}else i=n*(t-e),e=t}.bind(this)),this._eventInput.on("end",function(t){o||void 0===n||(this.emit("update",n),e=t)}.bind(this))}var s=t("../streams/Stream"),r=t("../core/_OptionsManager");n.DEFAULT_OPTIONS={scale:1},n.prototype=Object.create(s.prototype),n.prototype.constructor=n,i.exports=n}),i("samsara/streams/ReduceStream",["require","exports","module","./Stream","./SimpleStream","./Observable"],function(t,e,i){function n(t,e,i){this.reducer=t,this.options=i||{offset:0},this.prev=null,this.next=null,this.head=this,this.headOutput=new c,e?(this.value=e,this.input=new c,this.output=i.sources?u.lift(this.reducer,[this.input,this.value].concat(i.sources)):u.lift(this.reducer,[this.input,this.value])):(this.value=null,"number"==typeof this.options.offset?this.output=new p(this.options.offset):(this.output=new c,this.output.subscribe(this.options.offset))),a.call(this,this.head.output)}function s(t){for(var e=this;e&&e.value!==t;)e=e.next;return e}function r(t,e){t.next=null,e.prev=null,e.input.unsubscribe(t.output)}function o(t,e){t.next=e,e.prev=t,e.input.subscribe(t.output)}function a(t){this.headOutput.unsubscribe(),this.headOutput.subscribe(t)}var u=t("./Stream"),c=t("./SimpleStream"),p=t("./Observable");n.prototype=Object.create(u.prototype),n.prototype.constructor=n,n.prototype.push=function(t){this.head===this&&this.output.set&&this.output.set(this.options.offset||0);var e=new n(this.reducer,t,this.options);return o(this.head,e),this.head=e,a.call(this,this.head.output),e.input},n.prototype.pop=function(){var t=this.head.prev;r(t,this.head),this.head=t,a.call(this,this.head.output)},n.prototype.unshift=function(t){var e=this,i=e.next;if(!i)return this.push(t);var s=new n(this.reducer,t,this.options);return r(e,i),o(e,s),o(s,i),this.output.set&&this.output.set(this.options.offset||0),s.input},n.prototype.shift=function(){this.remove(this.next.value)},n.prototype.insertAfter=function(t,e){var i=s.call(this,t);if(i){var a=i.next;if(a){var u=new n(this.reducer,e,this.options);return r(i,a),o(u,a),o(i,u),u.input}return this.push(e)}},n.prototype.insertBefore=function(t,e){var i=s.call(this,t);if(i){var a=i.prev;if(a!==this){var u=new n(this.reducer,e,this.options);return r(a,i),o(u,i),o(a,u),u.input}return this.unshift(e)}},n.prototype.remove=function(t){var e=s.call(this,t);if(e){var i=e.prev,n=e.next;n?(r(e,n),r(i,e),o(i,n),this.output.set&&this.output.set(this.options.offset||0)):this.pop()}},i.exports=n}),i("samsara/layouts/SequentialLayout",["require","exports","module","../core/Transform","../core/View","../streams/ReduceStream","../streams/Stream"],function(t,e,i){function n(t){return this.options.direction===u.DIRECTION.X?s.translateX(t):s.translateY(t)}var s=t("../core/Transform"),r=t("../core/View"),o=t("../streams/ReduceStream"),a=t("../streams/Stream"),u={DIRECTION:{X:0,Y:1}},c=r.extend({defaults:{direction:u.DIRECTION.X,spacing:0,offset:0},initialize:function(t){this.nodes=[],this.stream=new o(function(e,i,n){return i?e+i[t.direction]+n:!1},void 0,{sources:[t.spacing],offset:t.offset}),this.setLengthMap(n);var e=a.lift(function(t,e){return Math.max(t-e,0)},[this.stream.headOutput,t.spacing]);this.output.subscribe(e);var i=[];this.size=a.lift(function(e,n){
return e&&void 0!==n?(i[t.direction]=n,i[1-t.direction]=e[1-t.direction],i):void 0},[this._size,e])},setLengthMap:function(t,e){this.transformMap=t.bind(this),e&&this.setSources(e)},setSources:function(t){this.sources=t},push:function(t){this.nodes.push(t);var e=this.stream.push(t.size),i=this.sources?a.lift(this.transformMap,[e].concat(this.sources)):e.map(this.transformMap);this.add({transform:i}).add(t)},pop:function(){return this.unlink(this.nodes.length-1)},unshift:function(t){this.nodes.unshift(t);var e=this.stream.unshift(t.size),i=e.map(this.transformMap);this.add({transform:i}).add(t)},shift:function(){return this.unlink(0)},insertAfter:function(t,e){var i;if("number"==typeof t?(i=t+1,t=this.nodes[t]):i=this.nodes.indexOf(t)+1,this.nodes.splice(i,0,e),!t)return this.push(e);var n=this.stream.insertAfter(t.size,e.size),s=n.map(this.transformMap);this.add({transform:s}).add(e)},insertBefore:function(t,e){var i;if("number"==typeof t?(i=t-1,t=this.nodes[t]):i=this.nodes.indexOf(t)-1,this.nodes.splice(i+1,0,e),!t)return this.unshift(e);var n=this.stream.insertBefore(t.size,e.size),s=n.map(this.transformMap);this.add({transform:s}).add(e)},unlink:function(t){var e;return"number"==typeof t?(e=t,t=this.nodes[t]):e=this.nodes.indexOf(t),t&&t.size?(this.nodes.splice(e,1),this.stream.remove(t.size),t):void 0}},u);i.exports=c}),i("samsara/inputs/GenericInput",["require","exports","module","../events/EventHandler","../streams/SimpleStream"],function(t,e,i){function n(t,e){this._eventInput=new r,this._eventOutput=new r,r.setInputHandler(this,this._eventInput),r.setOutputHandler(this,this._eventOutput),this._inputs={},t&&this.addInput(t,e)}function s(t,e){a[t]&&(this._inputs[t]=new a[t](e),this.subscribeInput(t))}var r=t("../events/EventHandler"),o=t("../streams/SimpleStream"),a={};n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.DIRECTION={X:0,Y:1},n.register=function(t){for(var e in t){if(a[e]){if(a[e]===t[e])continue;throw new Error("this key is registered to a different input class")}a[e]=t[e]}},n.prototype.setOptions=function(t){for(var e in this._inputs)this._inputs[e].setOptions(t)},n.prototype.subscribeInput=function(t){var e=this._inputs[t];e.subscribe(this._eventInput),this._eventOutput.subscribe(e)},n.prototype.unsubscribeInput=function(t){var e=this._inputs[t];e.unsubscribe(this._eventInput),this._eventOutput.unsubscribe(e)},n.prototype.getInput=function(t){return this._inputs[t]},n.prototype.addInput=function(t,e){if(t instanceof Array)for(var i=0;i<t.length;i++)s.call(this,t[i],e);else if(t instanceof Object)for(var n in t)s.call(this,n,t[n])},i.exports=n}),i("samsara/inputs/ScrollInput",["require","exports","module","../events/EventHandler","../core/_OptionsManager","../streams/SimpleStream","../core/Timer"],function(t,e,i){function n(t){this.options=o.setOptions(this,t),this._payload={delta:null,value:null,cumulate:null,velocity:null,event:null},this._eventInput=new r,this._eventOutput=new r,r.setInputHandler(this,this._eventInput),r.setOutputHandler(this,this._eventOutput),this._eventInput.on("wheel",s.bind(this)),this._value=void 0===this.options.direction?[0,0]:0,this._cumulate=void 0===this.options.direction?[0,0]:0,this._prevTime=void 0,this._inProgress=!1;var e=this;this._scrollEnd=u.debounce(function(t){e._inProgress=!1,0!==e._payload.delta&&(e._payload.velocity=0),e._payload.event=t,e._eventOutput.emit("end",e._payload)},100)}function s(t){if(t.preventDefault(),!this._inProgress)return this._value=void 0===this.options.direction?[0,0]:0,m=this._payload,m.value=this._value,m.cumulate=this._cumulate,m.event=t,this._eventOutput.emit("start",m),void(this._inProgress=!0);var e=h(),i=this._prevTime||e,s=-t.deltaX,r=-t.deltaY;s>p&&(s=p),r>p&&(r=p),-p>s&&(s=-p),-p>r&&(r=-p);var o=1/Math.max(e-i,c);this._prevTime=e;var a,u,l=s*o,d=r*o,f=this.options.scale;this.options.direction===n.DIRECTION.X?(u=f*s,a=f*l,this._value+=u,this._cumulate+=u):this.options.direction===n.DIRECTION.Y?(u=f*r,a=f*d,this._value+=u,this._cumulate+=u):(u=[f*s,f*r],a=[f*l,f*d],this._value[0]+=u[0],this._value[1]+=u[1],this._cumulate[0]+=u[0],this._cumulate[1]+=u[1]);var m=this._payload;m.delta=u,m.velocity=a,m.value=this._value,m.cumulate=this._cumulate,m.event=t,this._eventOutput.emit("update",m),this._scrollEnd(t)}var r=t("../events/EventHandler"),o=t("../core/_OptionsManager"),a=t("../streams/SimpleStream"),u=t("../core/Timer"),c=8,p=50;n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={direction:void 0,scale:1},n.DIRECTION={X:0,Y:1};var h=Date.now;i.exports=n}),i("samsara/inputs/_TouchTracker",["require","exports","module","../core/_OptionsManager","../events/EventHandler"],function(t,e,i){function n(t){this.options=u.setOptions(this,t),this.history={},this.numTouches=0,this._eventInput=new c,this._eventOutput=new c,c.setInputHandler(this,this._eventInput),c.setOutputHandler(this,this._eventOutput),this._eventInput.on("touchstart",r.bind(this)),this._eventInput.on("touchmove",o.bind(this)),this._eventInput.on("touchend",a.bind(this)),this._eventInput.on("touchcancel",a.bind(this))}function s(t,e,i){return{x:t.clientX,y:t.clientY,touchId:t.identifier,timestamp:p(),count:e.touches.length,event:t,history:i}}function r(t){if(t.touches.length>this.options.limit)return!1;if(this.numTouches>=this.options.track)return!1;for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n=i.identifier,r=s(i,t,null);this._eventOutput.emit("trackstart",r),this.history[n]||this.track(n,r)}}function o(t){if(t.touches.length>this.options.limit)return!1;if(this.numTouches>this.options.track)return!1;t.preventDefault();for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n=this.history[i.identifier];if(n){var r=s(i,t,n),o=n[this.options.memory-1];if(r.x===o.x&&r.y===o.y)continue;this._eventOutput.emit("trackmove",r),n.length>=this.options.memory&&n.shift(),n.push(r)}}}function a(t){if(t.touches.length>this.options.limit)return!1;if(this.numTouches>this.options.track)return!1;for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],n=i.identifier,r=this.history[n];if(r){var o=s(i,t,r);this._eventOutput.emit("trackend",o),this.untrack(n)}}}var u=t("../core/_OptionsManager"),c=t("../events/EventHandler"),p=Date.now;n.DEFAULT_OPTIONS={track:1,limit:1/0,memory:1},n.prototype.track=function(t,e){this.numTouches++,this.history[t]=[e]},n.prototype.untrack=function(t){this.numTouches--,delete this.history[t]},i.exports=n}),i("samsara/inputs/TouchInput",["require","exports","module","./_TouchTracker","../events/EventHandler","../streams/SimpleStream","../core/_OptionsManager"],function(t,e,i){function n(t){this.options=p.setOptions(this,t),this._eventOutput=new u,this._touchTracker=new a(this.options),u.setOutputHandler(this,this._eventOutput),u.setInputHandler(this,this._touchTracker),this._touchTracker.on("trackstart",s.bind(this)),this._touchTracker.on("trackmove",r.bind(this)),this._touchTracker.on("trackend",o.bind(this)),this._payload={},this._cumulate={},this._value={}}function s(t){var e,i,s=t.touchId,r={};void 0!==this.options.direction?(this.options.direction===n.DIRECTION.X&&(r.x=t.x),this.options.direction===n.DIRECTION.Y&&(r.y=t.y),this._cumulate[s]||(this._cumulate[s]=0),this._value[s]=0,e=0,i=0):(this._cumulate[s]||(this._cumulate[s]=[0,0]),this._value[s]=[0,0],e=[0,0],i=[0,0],r.x=t.x,r.y=t.y),r.delta=i,r.value=this._value[s],r.cumulate=this._cumulate[s],r.velocity=e,r.count=t.count,r.touchId=t.touchId,r.event=t.event,r.timestamp=t.timestamp,r.dt=0,this._payload[t.touchId]=r,this._eventOutput.emit("start",r)}function r(t){var e=this.options.direction,i=t.touchId,s=this._payload[i],r=this.options.scale,o=t.history[0],a=o.timestamp,u=t.timestamp,c=t.x,p=t.y,l=r*(c-o.x),d=r*(p-o.y);this.options.rails&&(e===n.DIRECTION.X&&Math.abs(d)>Math.abs(l)&&(d=0),e===n.DIRECTION.Y&&Math.abs(l)>Math.abs(d)&&(l=0));var f,m,v=Math.max(u-a,h),y=1/v,_=l*y,g=d*y;e===n.DIRECTION.X?(s.x=c,m=l,f=_,this._value[i]+=m,this._cumulate[i]+=m):e===n.DIRECTION.Y?(s.y=p,m=d,f=g,this._value[i]+=m,this._cumulate[i]+=m):(s.x=c,s.y=p,m=[l,d],f=[_,g],this._value[i][0]+=m[0],this._value[i][1]+=m[1],this._cumulate[i][0]+=m[0],this._cumulate[i][1]+=m[1]),s.delta=m,s.velocity=f,s.value=this._value[i],s.cumulate=this._cumulate[i],s.count=t.count,s.touchId=t.touchId,s.event=t.event,s.timestamp=t.timestamp,s.dt=v,this._eventOutput.emit("update",s)}function o(t){var e=t.touchId,i=this._payload[e];i.count=t.count,i.event=t.event,i.timestamp=t.timestamp,this._eventOutput.emit("end",i),delete this._payload[e],delete this._value[e],delete this._cumulate[e]}var a=t("./_TouchTracker"),u=t("../events/EventHandler"),c=t("../streams/SimpleStream"),p=t("../core/_OptionsManager"),h=8;n.prototype=Object.create(c.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={direction:void 0,scale:1,rails:!1,track:1,limit:1/0},n.DIRECTION={X:0,Y:1},i.exports=n}),i("samsara/inputs/MouseInput",["require","exports","module","../events/EventHandler","../core/_OptionsManager","../streams/SimpleStream"],function(t,e,i){function n(t){this.options=p.setOptions(this,t),this._eventInput=new c,this._eventOutput=new c,c.setInputHandler(this,this._eventInput),c.setOutputHandler(this,this._eventOutput),this.boundMove=null,this.boundUp=null,this._eventInput.on("mousedown",s.bind(this)),this._eventInput.on("mousemove",r.bind(this)),this._eventInput.on("mouseup",o.bind(this)),this._eventInput.on("mouseenter",a.bind(this)),this._eventInput.on("mouseleave",u.bind(this)),this._payload={x:0,y:0,delta:null,value:null,cumulate:null,velocity:null},this._value=null,this._cumulate=null,this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,this._move=!1}function s(t){var e,i;t.preventDefault();var s=t.clientX,r=t.clientY;this._prevCoord=[s,r],this._prevTime=d(),this._down=!0,this._move=!1;var o=this._payload;void 0!==this.options.direction?(null===this._cumulate&&(this._cumulate=0),this._value=0,e=0,i=0,this.options.direction===n.DIRECTION.X&&(o.x=s),this.options.direction===n.DIRECTION.Y&&(o.y=r)):(null===this._cumulate&&(this._cumulate=[0,0]),this._value=[0,0],e=[0,0],i=[0,0],o.x=s,o.y=r),o.delta=e,o.value=this._value,o.cumulate=this._cumulate,o.velocity=i,o.event=t,this._eventOutput.emit("start",o)}function r(t){if(!this._down)return!1;var e=this.options.direction,i=this.options.scale,s=this._prevCoord,r=this._prevTime,o=t.clientX,a=t.clientY,u=d(),c=i*(o-s[0]),p=i*(a-s[1]);if(this.options.rails&&void 0!==e){var h=e===n.DIRECTION.X&&Math.abs(c)<Math.abs(.5*p)||e===n.DIRECTION.Y&&Math.abs(p)<Math.abs(.5*c);if(h)return!1}var f,m,v=Math.max(u-r,l),y=1/v,_=c*y,g=p*y,b=this._payload;e===n.DIRECTION.X?(b.x=o,m=c,f=_,this._value+=m,this._cumulate+=m):e===n.DIRECTION.Y?(b.y=a,m=p,f=g,this._value+=m,this._cumulate+=m):(b.x=o,b.y=a,m=[c,p],f=[_,g],this._value[0]+=m[0],this._value[1]+=m[1],this._cumulate[0]+=m[0],this._cumulate[1]+=m[1]),b.delta=m,b.value=this._value,b.cumulate=this._cumulate,b.velocity=f,b.event=t,b.dt=v,this._eventOutput.emit("update",b),this._prevCoord=[o,a],this._prevTime=u,this._move=!0}function o(t){return this._down?(this._payload.event=t,this._eventOutput.emit("end",this._payload),this._prevCoord=void 0,this._prevTime=void 0,this._down=!1,void(this._move=!1)):!1}function a(t){return this._down&&this._move?(this._eventInput.off("mousemove",r.bind(this)),this._eventInput.off("mouseup",o.bind(this)),document.removeEventListener("mousemove",this.boundMove),void document.removeEventListener("mouseup",this.boundUp)):!1}function u(t){return this._down&&this._move?(this.boundMove=r.bind(this),this.boundUp=function(t){o.call(this,t),document.removeEventListener("mousemove",this.boundMove),document.removeEventListener("mouseup",this.boundUp)}.bind(this,t),this._eventInput.off("mousemove",r.bind(this)),this._eventInput.off("mouseup",o.bind(this)),document.addEventListener("mousemove",this.boundMove),void document.addEventListener("mouseup",this.boundUp)):!1}var c=t("../events/EventHandler"),p=t("../core/_OptionsManager"),h=t("../streams/SimpleStream"),l=8,d=Date.now;n.prototype=Object.create(h.prototype),n.prototype.constructor=n,n.DEFAULT_OPTIONS={direction:void 0,scale:1,rails:!1},n.DIRECTION={X:0,Y:1},i.exports=n}),i("samsara/layouts/ScrollView",["require","exports","module","../core/Transform","../core/Transitionable","../core/View","../streams/Stream","../streams/Accumulator","../streams/Differential","./SequentialLayout","../dom/ContainerSurface","../inputs/GenericInput","../inputs/ScrollInput","../inputs/TouchInput","../inputs/MouseInput"],function(t,e,i){function n(t){t!==this._previousIndex&&(this.emit("page",t),this._previousIndex=t)}function s(t,e){this.drag.halt(),this.spring.reset(t),this.options.edgeTransition.velocity=e,this.spring.set(0,this.options.edgeTransition)}function r(t){var e,i=this.options.pageChangeSpeed,n=this.items[this._currentIndex].getSize()[this.options.direction],s=this.itemOffset,r=this.itemOffset-n,o=this.itemOffset,a=n/2;e=0>t?o>a||-i>t?r:s:a>o||t>i?s:r,this.options.pageTransition.velocity=t,this.spring.halt(),this.spring.reset(-e),this.spring.set(0,this.options.pageTransition)}function o(t){this.drag.halt(),this.drag.reset(0),this.drag.set(0,{curve:"inertia",velocity:t,drag:this.options.drag})}var a=t("../core/Transform"),u=t("../core/Transitionable"),c=t("../core/View"),p=t("../streams/Stream"),h=t("../streams/Accumulator"),l=t("../streams/Differential"),d=t("./SequentialLayout"),f=t("../dom/ContainerSurface"),m=t("../inputs/GenericInput"),v=t("../inputs/ScrollInput"),y=t("../inputs/TouchInput"),_=t("../inputs/MouseInput");m.register({touch:y,scroll:v,mouse:_});var g={DIRECTION:{X:0,Y:1}},b={TOP:-1,BOTTOM:1,NONE:0},O=c.extend({defaults:{direction:g.DIRECTION.Y,drag:.3,paginated:!1,pageChangeSpeed:.5,startPosition:0,marginTop:0,marginBottom:0,clip:!0,enableMouseDrag:!1,pageTransition:{curve:"spring",period:100,damping:.8},edgeTransition:{curve:"spring",period:100,damping:1},edgeGrip:.5},initialize:function(t){this._currentIndex=0,this._previousIndex=0,this.itemOffset=0,this.items=[],this.velocity=0,this.overflow=0;var e=!1,i=!1,c=b.NONE;this.layout=new d({direction:t.direction});var v=t.enableMouseDrag?["touch","scroll","mouse"]:["touch","scroll"],y=new m(v,{direction:t.direction}),_=new h(-t.startPosition);this.drag=new u(0),this.spring=new u(0);var O=new l,T=new l,S=y.pluck("delta");O.subscribe(this.drag),T.subscribe(this.spring),_.subscribe(S),_.subscribe(O),_.subscribe(T);var w=y.getInput("scroll");w.on("start",function(){i=!0}),w.on("end",function(){i=!1}),y.on("start",function(){e=!0,this.drag.halt(),this.spring.halt()}.bind(this)),y.on("update",function(t){this.velocity=t.velocity}.bind(this)),y.on("end",function(t){switch(e=!1,c){case b.NONE:this.options.paginated?r.call(this,t.velocity):o.call(this,t.velocity);break;case b.TOP:s.call(this,this.overflow,t.velocity);break;case b.BOTTOM:s.call(this,this.overflow,t.velocity)}}.bind(this)),this.drag.on("update",function(){this.velocity=this.drag.getVelocity()}.bind(this)),this.spring.on("update",function(){this.velocity=this.spring.getVelocity()}.bind(this)),_.on("end",function(){this.spring.isActive()||n.call(this,this._currentIndex)}.bind(this));var x=p.lift(function(e,i){if(!e)return!1;var n=i[t.direction]-t.marginBottom-e;return n>=0?!1:n},[this.layout,this.size]);this.offset=p.lift(function(t,r){if(!r)return!1;if(this.spring.isActive())return Math.round(t);if(t>0){if(i)return c=b.TOP,_.set(0,!0),n.call(this,this._currentIndex),0;this.overflow=t,c!==b.TOP&&(y.setOptions({scale:this.options.edgeGrip}),c=b.TOP,e||s.call(this,this.overflow,this.velocity))}else if(r>t){if(i)return c=b.BOTTOM,_.set(r,!0),n.call(this,this._currentIndex),r;this.overflow=t-r,c!==b.BOTTOM&&(y.setOptions({scale:.5}),c=b.BOTTOM,e||s.call(this,this.overflow,this.velocity))}else t>r&&0>t&&c!==b.NONE&&(this.overflow=0,y.setOptions({scale:1}),c=b.NONE);return Math.round(t)}.bind(this),[_,x]);var I=this.offset.map(function(e){return e+=t.marginTop,t.direction===g.DIRECTION.Y?a.translateY(e):a.translateX(e)});this.container=new f({properties:{overflow:"hidden"}}),y.subscribe(this.container),this.container.add({transform:I}).add(this.layout),this.add(this.container)},setPerspective:function(){f.prototype.setPerspective.apply(this.container,arguments)},getVelocity:function(){return this.velocity},goTo:function(t,e,i){e=e||this.options.pageTransition;var n,s=this.itemOffset;if(t>this._currentIndex&&t<this.items.length)for(n=this._currentIndex;t>n;n++)s-=this.items[n].getSize()[this.options.direction];else if(t<this._currentIndex&&t>=0)for(n=this._currentIndex;n>t;n--)s+=this.items[n].getSize()[this.options.direction];this.spring.halt(),this.spring.reset(0),this.spring.set(Math.ceil(s),e,i)},getCurrentIndex:function(){return this._currentIndex},addItems:function(t){for(var e=0;e<t.length;e++)this.layout.push(t[e]);this.items=t;var i=[this.offset];for(e=0;e<t.length;e++)i.push(t[e].size);var n=0,s=p.lift(function(){if(void 0===arguments[0]||void 0===arguments[1])return!1;var e=arguments[0],i=this.options.direction,s=this._currentIndex,r=arguments[s+1];if(!r)return!1;var o=0,a=-e-n,u=r[i];return a>=u&&this._currentIndex!==t.length-1?(this._currentIndex++,o=0,n+=u):0>a&&0!==this._currentIndex?(this._currentIndex--,o=1,u=arguments[this._currentIndex+1][i],n-=u):o=a/u,this.itemOffset=a,{index:this._currentIndex,progress:o}}.bind(this),i);this.output.subscribe(s),s.on("start",function(){}),s.on("update",function(){}),s.on("end",function(){})}},g);i.exports=O}),i("samsara/layouts/HeaderFooterLayout",["require","exports","module","../core/Transform","../core/View","../streams/Stream"],function(t,e,i){var n=t("../core/Transform"),s=t("../core/View"),r=t("../streams/Stream"),o=s.extend({defaults:{header:null,content:null,footer:null},initialize:function(t){this.contentNode=null;var e,i;t.header?(i=t.header.size.map(function(t){return t?n.translateY(t[1]):!1}),e=t.footer?r.lift(function(t,e,i){return t&&e?[i[0],i[1]-t[1]-e[1]]:!1},[t.header.size,t.footer.size,this.size]):r.lift(function(t,e){return t&&e?[e[0],e[1]-t[1]]:!1},[t.header.size,this.size]),this.add(t.header),this.contentNode=this.add({transform:i,size:e})):t.footer&&(e=r.lift(function(t,e){return t?[e[0],e[1]-t[1]]:!1},[t.footer.size,this.size]),this.contentNode=this.add({size:e})),t.footer&&(i=t.footer.size.map(function(t){return n.translateY(-t[1])}),this.add({align:[0,1],transform:i}).add(t.footer)),t.content&&this.addContent(t.content)},addContent:function(t){this.options.content=t,this.contentNode.add(t)}});i.exports=o}),i("main",["require","exports","module","samsara/dom/Context","samsara/dom/Surface","samsara/dom/ContainerSurface","samsara/core/Transitionable","samsara/layouts/ScrollView","samsara/layouts/SequentialLayout","samsara/layouts/HeaderFooterLayout","samsara/core/Transform"],function(t,e,i){var n=t("samsara/dom/Context"),s=t("samsara/dom/Surface"),r=t("samsara/dom/ContainerSurface"),o=t("samsara/core/Transitionable"),a=t("samsara/layouts/ScrollView"),u=t("samsara/layouts/SequentialLayout"),c=t("samsara/layouts/HeaderFooterLayout"),p=t("samsara/core/Transform"),h=new r({classes:["center"]}),l=[],d=new a({direction:1,drag:.3,pageTransitions:{duration:500,curve:"easeOut"}}),f=new o(0),m=new o(0),v=new r({properties:{background:"#256a17"}}),y=new s({content:'<iframe width="840" height="473" src="https://www.youtube.com/embed/opDQmxIRsrI" frameborder="0" allowfullscreen></iframe>',size:[void 0,void 0],classes:["content","center"],opacity:f});v.add(y);var _=new s({size:[void 0,40],origin:[.5,.5],content:"Changing the legal document drafting world!",opacity:m,properties:{fontSize:"30px",color:"#b3b3b3",textAlign:"center",fontWeight:"bold"}});v.add({align:[.5,.5],transform:p.translate([0,280])}).add(_),l.push(v);var g=new r({size:[void 0,void 0],properties:{background:"#b3b3b3"}}),b=new s({size:[100,30],origin:[.5,0],content:"About",properties:{fontSize:"60px",color:"#256a17",fontWeight:"bold"}});g.add({align:[.5,0]}).add({transform:p.translate([0,100])}).add(b);var O=new s({size:[void 0,0],origin:[.5,0],content:"LegalTool is a new way to draft legal documents. Using either a markup or scripting language, documents can be defined in such a way that they are also machine readable. Once a document is machine readable, these “smart contracts” can be easily catalogued, searched, and modified with ease. With important meta-data about the parties and clauses stored within the documents, they could even be rendered in a “layman” format that can be easily interpreted by the common man. ",properties:{color:"#256a17",paddingTop:"50px",paddingRight:"200px",paddingBottom:"50px",paddingLeft:"200px",fontSize:"30px"}});g.add({align:[.5,0],transform:p.translate([0,200])}).add(O),l.push(g);var T=new r({classes:["center"],properties:{background:"#256a17"}}),S=new s({tagName:"table",content:'<tr><td><img src="assets/document.png"></td><td><img src="assets/bulb.png"></td><td><img src="assets/settings.png"></td></tr><tr><td>Document Markup/Scripting</td><td>Smart Documents</td><td>Easily changable</td></tr>',classes:["center"],properties:{paddingTop:"40px",paddingRight:"40px",paddingBottom:"40px",paddingLeft:"40px",maxHeight:"150px",maxWidth:"500px",color:"#b3b3b3"}});T.add(S),l.push(T),h.add(d),d.addItems(l);var w=new o([void 0,0]),x=new r({size:w,classes:["header"],properties:{fontSize:"50px",textAlign:"right"}}),I=new s({tagName:"img",size:[!0,void 0],attributes:{src:"assets/LegalToolLogo.png"}});x.add(I);var z=new s({tagName:"img",size:[!0,void 0],attributes:{src:"assets/LegalToolText.png"}});x.add({transform:p.translate([100,0])}).add(z);var N=75,E=25,M=new u({direction:0}),C=new s({size:[N,E],content:"Home",classes:["headerButton"]});C.on("click",function(){d.goTo(0)}),M.push(C);var q=new s({size:[N,E],content:"About",classes:["headerButton"]});q.on("click",function(){d.goTo(1)}),M.push(q);var D=new s({size:[N,E],content:"Service",classes:["headerButton"]});D.on("click",function(){d.goTo(2)}),M.push(D);var A=new r({size:[3*N,E],origin:[1,0]});A.add(M),x.add({align:[1,0],transform:p.translate([-20,0])}).add(A);var k=new c({header:x,content:h}),L=new n;L.add(k),L.mount(document.body),w.set([void 0,100],{duration:1e3,curve:"easeOut"},function(){f.set(1,{duration:1500,curve:"easeOut"},function(){m.set(1,{duration:1500,curve:"easeOut"})})})}),e(["main"])}();